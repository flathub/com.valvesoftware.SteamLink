diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/cmake/tvos/Info.plist.app.in qt-everywhere-src-6.9.2/qtbase/cmake/tvos/Info.plist.app.in
--- qt-everywhere-src-6.9.2.orig/qtbase/cmake/tvos/Info.plist.app.in	1969-12-31 16:00:00.000000000 -0800
+++ qt-everywhere-src-6.9.2/qtbase/cmake/tvos/Info.plist.app.in	2025-10-02 14:40:35.401300607 -0700
@@ -0,0 +1,39 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
+<plist version="1.0">
+<dict>
+	<key>CFBundleDevelopmentRegion</key>
+	<string>en</string>
+	<key>CFBundleDisplayName</key>
+	<string>${PRODUCT_NAME}</string>
+	<key>CFBundleExecutable</key>
+	<string>${EXECUTABLE_NAME}</string>
+	<key>CFBundleIcons</key>
+	<dict>
+		<key>CFBundlePrimaryIcon</key>
+		<string>App Icon - Small</string>
+	</dict>
+	<key>CFBundleIdentifier</key>
+	<string>${PRODUCT_BUNDLE_IDENTIFIER}</string>
+	<key>CFBundleName</key>
+	<string>${PRODUCT_NAME}</string>
+	<key>CFBundlePackageType</key>
+	<string>APPL</string>
+	<key>CFBundleShortVersionString</key>
+	<string>${QMAKE_SHORT_VERSION}</string>
+	<key>CFBundleSignature</key>
+	<string>${QMAKE_PKGINFO_TYPEINFO}</string>
+	<key>CFBundleSupportedPlatforms</key>
+	<array>
+		<string>AppleTVOS</string>
+	</array>
+	<key>CFBundleVersion</key>
+	<string>${QMAKE_FULL_VERSION}</string>
+	<key>LSRequiresIPhoneOS</key>
+	<true/>
+	<key>MinimumOSVersion</key>
+	<string>${TVOS_DEPLOYMENT_TARGET}</string>
+	<key>NOTE</key>
+	<string>This file was generated by Qt/QMake.</string>
+</dict>
+</plist>
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/config.tests/x86intrin/main.cpp qt-everywhere-src-6.9.2/qtbase/config.tests/x86intrin/main.cpp
--- qt-everywhere-src-6.9.2.orig/qtbase/config.tests/x86intrin/main.cpp	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/config.tests/x86intrin/main.cpp	2025-10-02 14:40:35.401355060 -0700
@@ -12,7 +12,7 @@
 {
     unsigned randomvalue;
     _rdrand32_step(&randomvalue);               // RDRND (IVB)
-#ifndef __QNXNTO__  // buggy compiler is missing this intrinsic, but we allow it
+#if 0//ndef __QNXNTO__  // buggy compiler is missing this intrinsic, but we allow it
     _rdseed32_step(&randomvalue);               // RDSEED (BDW)
 #endif
     unsigned mask = _blsmsk_u32(argc);          // BMI (HSW)
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/android-g++/qmake.conf.dist qt-everywhere-src-6.9.2/qtbase/mkspecs/android-g++/qmake.conf.dist
--- qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/android-g++/qmake.conf.dist	1969-12-31 16:00:00.000000000 -0800
+++ qt-everywhere-src-6.9.2/qtbase/mkspecs/android-g++/qmake.conf.dist	2025-10-02 14:40:35.401501997 -0700
@@ -0,0 +1,37 @@
+# qmake configuration for building with android-g++
+MAKEFILE_GENERATOR      = UNIX
+QMAKE_PLATFORM          = android
+QMAKE_COMPILER          = gcc
+
+CONFIG                 += android_install unversioned_soname unversioned_libname plugin_with_soname android_deployment_settings
+
+include(../common/linux.conf)
+include(../common/gcc-base-unix.conf)
+include(../common/android-base-head.conf)
+
+QMAKE_CC                = $${CROSS_COMPILE}gcc
+QMAKE_CXX               = $${CROSS_COMPILE}g++
+QMAKE_LINK              = $$QMAKE_CXX
+
+ANDROID_SOURCES_CXX_STL_LIBDIR = $$NDK_ROOT/sources/cxx-stl/gnu-libstdc++/$$NDK_TOOLCHAIN_VERSION/libs/$$ANDROID_TARGET_ARCH
+ANDROID_STDCPP_PATH            = $$ANDROID_SOURCES_CXX_STL_LIBDIR/libgnustl_shared.so
+ANDROID_CXX_STL_LIBS           = -lgnustl_shared -lgcc
+
+exists($$NDK_ROOT/sysroot/usr/include): \
+        QMAKE_CFLAGS += --sysroot=$$NDK_ROOT/sysroot \
+                        -isystem $$NDK_ROOT/sysroot/usr/include/$$NDK_TOOLS_PREFIX
+else:   QMAKE_CFLAGS += --sysroot=$$ANDROID_PLATFORM_ROOT_PATH
+
+QMAKE_CFLAGS += -isystem $$NDK_ROOT/sources/cxx-stl/gnu-libstdc++/$$NDK_TOOLCHAIN_VERSION/include \
+                -isystem $$ANDROID_SOURCES_CXX_STL_LIBDIR/include
+
+equals(ANDROID_TARGET_ARCH, armeabi)|equals(ANDROID_TARGET_ARCH, armeabi-v7a): \
+    LIBGCC_PATH_FULL = $$system("$$QMAKE_CXX -mthumb-interwork -print-libgcc-file-name")
+else: \
+    LIBGCC_PATH_FULL = $$system("$$QMAKE_CXX -print-libgcc-file-name")
+ANDROID_SOURCES_CXX_STL_LIBDIR += $$dirname(LIBGCC_PATH_FULL)
+
+QMAKE_ARM_CFLAGS_RELEASE                   = -Os
+QMAKE_ARM_CFLAGS_RELEASE_WITH_DEBUGINFO    = -g -Os
+
+include(../common/android-base-tail.conf)
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/common/gcc-base.conf qt-everywhere-src-6.9.2/qtbase/mkspecs/common/gcc-base.conf
--- qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/common/gcc-base.conf	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/mkspecs/common/gcc-base.conf	2025-10-02 14:40:35.401557301 -0700
@@ -41,7 +41,7 @@
 QMAKE_CFLAGS_WARN_ON       += -Wall -Wextra
 QMAKE_CFLAGS_WARN_OFF      += -w
 QMAKE_CFLAGS_RELEASE       += $$QMAKE_CFLAGS_OPTIMIZE
-QMAKE_CFLAGS_RELEASE_WITH_DEBUGINFO += $$QMAKE_CFLAGS_OPTIMIZE -g
+QMAKE_CFLAGS_RELEASE_WITH_DEBUGINFO += $$QMAKE_CFLAGS_OPTIMIZE -g -fno-omit-frame-pointer
 QMAKE_CFLAGS_DEBUG         += -g
 QMAKE_CFLAGS_SHLIB         += $$QMAKE_CFLAGS_PIC
 QMAKE_CFLAGS_STATIC_LIB    += $$QMAKE_CFLAGS_PIC
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/devices/linux-marvell-g++/qeglfshooks_marvell.cpp qt-everywhere-src-6.9.2/qtbase/mkspecs/devices/linux-marvell-g++/qeglfshooks_marvell.cpp
--- qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/devices/linux-marvell-g++/qeglfshooks_marvell.cpp	1969-12-31 16:00:00.000000000 -0800
+++ qt-everywhere-src-6.9.2/qtbase/mkspecs/devices/linux-marvell-g++/qeglfshooks_marvell.cpp	2025-10-02 14:40:35.401689160 -0700
@@ -0,0 +1,103 @@
+/****************************************************************************
+**
+** Copyright (C) 2013 Digia Plc and/or its subsidiary(-ies).
+** Contact: http://www.qt-project.org/legal
+**
+** This file is part of the qmake spec of the Qt Toolkit.
+**
+** $QT_BEGIN_LICENSE:LGPL$
+** Commercial License Usage
+** Licensees holding valid commercial Qt licenses may use this file in
+** accordance with the commercial license agreement provided with the
+** Software or, alternatively, in accordance with the terms contained in
+** a written agreement between you and Digia.  For licensing terms and
+** conditions see http://qt.digia.com/licensing.  For further information
+** use the contact form at http://qt.digia.com/contact-us.
+**
+** GNU Lesser General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU Lesser
+** General Public License version 2.1 as published by the Free Software
+** Foundation and appearing in the file LICENSE.LGPL included in the
+** packaging of this file.  Please review the following information to
+** ensure the GNU Lesser General Public License version 2.1 requirements
+** will be met: http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
+**
+** In addition, as a special exception, Digia gives you certain additional
+** rights.  These rights are described in the Digia Qt LGPL Exception
+** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
+**
+** GNU General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU
+** General Public License version 3.0 as published by the Free Software
+** Foundation and appearing in the file LICENSE.GPL included in the
+** packaging of this file.  Please review the following information to
+** ensure the GNU General Public License version 3.0 requirements will be
+** met: http://www.gnu.org/copyleft/gpl.html.
+**
+**
+** $QT_END_LICENSE$
+**
+****************************************************************************/
+
+#include "qeglfshooks_p.h"
+#include <EGL/eglvivante.h>
+#include <QDebug>
+
+QT_BEGIN_NAMESPACE
+
+class QEglFSMarvellHooks : public QEglFSHooks
+{
+public:
+    QEglFSMarvellHooks();
+	void platformInit() Q_DECL_OVERRIDE { }
+	void platformDestroy() Q_DECL_OVERRIDE { }
+    QSize screenSize() const Q_DECL_OVERRIDE;
+    EGLNativeWindowType createNativeWindow(QPlatformWindow *window, const QSize &size, const QSurfaceFormat &format) Q_DECL_OVERRIDE;
+    void destroyNativeWindow(EGLNativeWindowType window) Q_DECL_OVERRIDE;
+    EGLNativeDisplayType platformDisplay() const Q_DECL_OVERRIDE;
+
+private:
+    QSize mScreenSize;
+    EGLNativeDisplayType mNativeDisplay;
+};
+
+
+QEglFSMarvellHooks::QEglFSMarvellHooks()
+{
+    int width, height;
+
+    mNativeDisplay = fbGetDisplayByIndex(framebufferIndex());
+    fbGetDisplayGeometry(mNativeDisplay, &width, &height);
+    mScreenSize.setHeight(height);
+    mScreenSize.setWidth(width);
+}
+
+QSize QEglFSMarvellHooks::screenSize() const
+{
+    return mScreenSize;
+}
+
+EGLNativeDisplayType QEglFSMarvellHooks::platformDisplay() const
+{
+    return mNativeDisplay;
+}
+
+EGLNativeWindowType QEglFSMarvellHooks::createNativeWindow(QPlatformWindow *window, const QSize &size, const QSurfaceFormat &format)
+{
+    Q_UNUSED(window)
+    Q_UNUSED(format)
+
+    EGLNativeWindowType eglWindow = fbCreateWindow(mNativeDisplay, 0, 0, size.width(), size.height());
+    return eglWindow;
+}
+
+
+void QEglFSMarvellHooks::destroyNativeWindow(EGLNativeWindowType window)
+{
+    fbDestroyWindow(window);
+}
+
+QEglFSMarvellHooks eglFSMarvellHooks;
+QEglFSHooks *platformHooks = &eglFSMarvellHooks;
+
+QT_END_NAMESPACE
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/devices/linux-marvell-g++/qmake.conf qt-everywhere-src-6.9.2/qtbase/mkspecs/devices/linux-marvell-g++/qmake.conf
--- qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/devices/linux-marvell-g++/qmake.conf	1969-12-31 16:00:00.000000000 -0800
+++ qt-everywhere-src-6.9.2/qtbase/mkspecs/devices/linux-marvell-g++/qmake.conf	2025-10-02 14:40:35.401728043 -0700
@@ -0,0 +1,25 @@
+#
+# qmake configuration for the Marvell BG2CD
+#
+include(../common/linux_device_pre.conf)
+
+EGLFS_PLATFORM_HOOKS_SOURCES = $$PWD/qeglfshooks_marvell.cpp
+
+MARVELL_SDK            = $$(MARVELL_SDK_PATH)
+MARVELL_APPROOT        = $$MARVELL_SDK/MRVL/MV88DE3100_SDK/Customization_Data/File_Systems/application_steam
+
+QMAKE_LIBS_EGL         += -lEGL -lGAL -lVSC -lshm -lOSAL -lPEAgent
+QMAKE_LIBS_OPENGL_ES2  += -lGLESv2 $$QMAKE_LIBS_EGL
+QMAKE_LIBS_OPENVG      += -lOpenVG $$QMAKE_LIBS_EGL
+
+QMAKE_LFLAGS           += -Wl,-rpath-link,$$[QT_SYSROOT]/lib -Wl,-rpath-link,$$[QT_SYSROOT]/usr/lib -Wl,-rpath-link,$$[QT_SYSROOT]/usr/lib/arm-linux-gnueabihf -L$$MARVELL_APPROOT/lib
+QMAKE_LFLAGS           += --sysroot=$$[QT_SYSROOT]
+
+MARVELL_CFLAGS         = -I$$MARVELL_APPROOT/include -DLINUX -DEGL_API_FB
+QMAKE_CFLAGS           += $$MARVELL_CFLAGS
+QMAKE_CXXFLAGS         += $$MARVELL_CFLAGS
+DISTRO_OPTS            += hard-float
+
+include(../common/linux_arm_device_post.conf)
+
+load(qt_config)
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/devices/linux-marvell-g++/qmake.conf.directfb qt-everywhere-src-6.9.2/qtbase/mkspecs/devices/linux-marvell-g++/qmake.conf.directfb
--- qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/devices/linux-marvell-g++/qmake.conf.directfb	1969-12-31 16:00:00.000000000 -0800
+++ qt-everywhere-src-6.9.2/qtbase/mkspecs/devices/linux-marvell-g++/qmake.conf.directfb	2025-10-02 14:40:35.401775413 -0700
@@ -0,0 +1,13 @@
+#
+# qmake configuration for the Marvell BG2CD
+#
+include(../common/linux_device_pre.conf)
+
+QMAKE_INCDIR           += $$[QT_SYSROOT]/usr/include
+QMAKE_LIBDIR           += $$[QT_SYSROOT]/usr/lib
+
+QMAKE_LFLAGS           += -Wl,-rpath-link,$$[QT_SYSROOT]/usr/lib
+
+include(../common/linux_arm_device_post.conf)
+
+load(qt_config)
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/devices/linux-marvell-g++/qplatformdefs.h qt-everywhere-src-6.9.2/qtbase/mkspecs/devices/linux-marvell-g++/qplatformdefs.h
--- qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/devices/linux-marvell-g++/qplatformdefs.h	1969-12-31 16:00:00.000000000 -0800
+++ qt-everywhere-src-6.9.2/qtbase/mkspecs/devices/linux-marvell-g++/qplatformdefs.h	2025-10-02 14:40:35.401818123 -0700
@@ -0,0 +1,42 @@
+/****************************************************************************
+**
+** Copyright (C) 2013 Digia Plc and/or its subsidiary(-ies).
+** Contact: http://www.qt-project.org/legal
+**
+** This file is part of the qmake spec of the Qt Toolkit.
+**
+** $QT_BEGIN_LICENSE:LGPL$
+** Commercial License Usage
+** Licensees holding valid commercial Qt licenses may use this file in
+** accordance with the commercial license agreement provided with the
+** Software or, alternatively, in accordance with the terms contained in
+** a written agreement between you and Digia.  For licensing terms and
+** conditions see http://qt.digia.com/licensing.  For further information
+** use the contact form at http://qt.digia.com/contact-us.
+**
+** GNU Lesser General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU Lesser
+** General Public License version 2.1 as published by the Free Software
+** Foundation and appearing in the file LICENSE.LGPL included in the
+** packaging of this file.  Please review the following information to
+** ensure the GNU Lesser General Public License version 2.1 requirements
+** will be met: http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
+**
+** In addition, as a special exception, Digia gives you certain additional
+** rights.  These rights are described in the Digia Qt LGPL Exception
+** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
+**
+** GNU General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU
+** General Public License version 3.0 as published by the Free Software
+** Foundation and appearing in the file LICENSE.GPL included in the
+** packaging of this file.  Please review the following information to
+** ensure the GNU General Public License version 3.0 requirements will be
+** met: http://www.gnu.org/copyleft/gpl.html.
+**
+**
+** $QT_END_LICENSE$
+**
+****************************************************************************/
+
+#include "../../linux-g++/qplatformdefs.h"
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/devices/linux-rasp-pi3-g++/qmake.conf qt-everywhere-src-6.9.2/qtbase/mkspecs/devices/linux-rasp-pi3-g++/qmake.conf
--- qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/devices/linux-rasp-pi3-g++/qmake.conf	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/mkspecs/devices/linux-rasp-pi3-g++/qmake.conf	2025-10-02 14:40:35.401879278 -0700
@@ -11,9 +11,9 @@
 QMAKE_RPATHLINKDIR_POST += $$[QT_SYSROOT]/opt/vc/lib
 
 VC_LIBRARY_PATH         = /opt/vc/lib
-VC_INCLUDE_PATH         = =/opt/vc/include
+VC_INCLUDE_PATH         = /opt/vc/include
 
-VC_LINK_LINE            = -L=$${VC_LIBRARY_PATH}
+VC_LINK_LINE            = -L$${VC_LIBRARY_PATH}
 
 QMAKE_LIBDIR_OPENGL_ES2 = =$${VC_LIBRARY_PATH}
 QMAKE_LIBDIR_EGL        = $$QMAKE_LIBDIR_OPENGL_ES2
@@ -26,10 +26,10 @@
 
 QMAKE_INCDIR_OPENGL_ES2 = $${QMAKE_INCDIR_EGL}
 
-QMAKE_LIBS_OPENGL_ES2   = $${VC_LINK_LINE} -lGLESv2
+QMAKE_LIBS_OPENGL_ES2   = $${VC_LINK_LINE} -lbrcmGLESv2
 
 # The official opt vc EGL references GLESv2 symbols: need to link it
-QMAKE_LIBS_EGL          = $${VC_LINK_LINE} -lEGL -lGLESv2
+QMAKE_LIBS_EGL          = $${VC_LINK_LINE} -lbrcmEGL -lbrcmGLESv2
 
 QMAKE_LIBDIR_BCM_HOST   = =$$VC_LIBRARY_PATH
 QMAKE_INCDIR_BCM_HOST   = $$VC_INCLUDE_PATH
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/dummy/qplatformdefs.h qt-everywhere-src-6.9.2/qtbase/mkspecs/dummy/qplatformdefs.h
--- qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/dummy/qplatformdefs.h	1969-12-31 16:00:00.000000000 -0800
+++ qt-everywhere-src-6.9.2/qtbase/mkspecs/dummy/qplatformdefs.h	2025-10-02 14:40:35.401959109 -0700
@@ -0,0 +1,19 @@
+// Copyright (C) 2016 The Qt Company Ltd.
+// SPDX-License-Identifier: LicenseRef-Qt-Commercial OR LGPL-3.0-only OR GPL-2.0-only OR GPL-3.0-only
+
+// Get Qt defines/settings
+
+#include "qglobal.h"
+
+#ifdef _WIN32
+#include "../win32-msvc/qplatformdefs.h"
+#elif defined(__APPLE__)
+#include "../common/mac/qplatformdefs.h"
+#else
+#include <dirent.h>
+#include <fcntl.h>
+#include <sys/time.h>
+#include <unistd.h>
+
+#include "../common/posix/qplatformdefs.h"
+#endif
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/linux-g++-5/qmake.conf qt-everywhere-src-6.9.2/qtbase/mkspecs/linux-g++-5/qmake.conf
--- qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/linux-g++-5/qmake.conf	1969-12-31 16:00:00.000000000 -0800
+++ qt-everywhere-src-6.9.2/qtbase/mkspecs/linux-g++-5/qmake.conf	2025-10-02 14:40:35.402024192 -0700
@@ -0,0 +1,17 @@
+#
+# qmake configuration for linux-g++
+#
+
+MAKEFILE_GENERATOR      = UNIX
+CONFIG                 += incremental
+QMAKE_INCREMENTAL_STYLE = sublib
+
+include(../common/linux.conf)
+include(../common/gcc-base-unix.conf)
+include(../common/g++-unix.conf)
+load(qt_config)
+
+QMAKE_CXX               = g++-5
+QMAKE_LINK              = g++-5
+QMAKE_CC                = gcc-5
+QMAKE_LINK_C            = gcc-5
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/linux-g++-5/qplatformdefs.h qt-everywhere-src-6.9.2/qtbase/mkspecs/linux-g++-5/qplatformdefs.h
--- qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/linux-g++-5/qplatformdefs.h	1969-12-31 16:00:00.000000000 -0800
+++ qt-everywhere-src-6.9.2/qtbase/mkspecs/linux-g++-5/qplatformdefs.h	2025-10-02 14:40:35.402057044 -0700
@@ -0,0 +1,95 @@
+/****************************************************************************
+**
+** Copyright (C) 2016 The Qt Company Ltd.
+** Contact: https://www.qt.io/licensing/
+**
+** This file is part of the qmake spec of the Qt Toolkit.
+**
+** $QT_BEGIN_LICENSE:LGPL$
+** Commercial License Usage
+** Licensees holding valid commercial Qt licenses may use this file in
+** accordance with the commercial license agreement provided with the
+** Software or, alternatively, in accordance with the terms contained in
+** a written agreement between you and The Qt Company. For licensing terms
+** and conditions see https://www.qt.io/terms-conditions. For further
+** information use the contact form at https://www.qt.io/contact-us.
+**
+** GNU Lesser General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU Lesser
+** General Public License version 3 as published by the Free Software
+** Foundation and appearing in the file LICENSE.LGPL3 included in the
+** packaging of this file. Please review the following information to
+** ensure the GNU Lesser General Public License version 3 requirements
+** will be met: https://www.gnu.org/licenses/lgpl-3.0.html.
+**
+** GNU General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU
+** General Public License version 2.0 or (at your option) the GNU General
+** Public license version 3 or any later version approved by the KDE Free
+** Qt Foundation. The licenses are as published by the Free Software
+** Foundation and appearing in the file LICENSE.GPL2 and LICENSE.GPL3
+** included in the packaging of this file. Please review the following
+** information to ensure the GNU General Public License requirements will
+** be met: https://www.gnu.org/licenses/gpl-2.0.html and
+** https://www.gnu.org/licenses/gpl-3.0.html.
+**
+** $QT_END_LICENSE$
+**
+****************************************************************************/
+
+#ifndef QPLATFORMDEFS_H
+#define QPLATFORMDEFS_H
+
+// Get Qt defines/settings
+
+#include "qglobal.h"
+
+// Set any POSIX/XOPEN defines at the top of this file to turn on specific APIs
+
+// 1) need to reset default environment if _BSD_SOURCE is defined
+// 2) need to specify POSIX thread interfaces explicitly in glibc 2.0
+// 3) it seems older glibc need this to include the X/Open stuff
+#ifndef _GNU_SOURCE
+#  define _GNU_SOURCE
+#endif
+
+#include <unistd.h>
+
+
+// We are hot - unistd.h should have turned on the specific APIs we requested
+
+#include <features.h>
+#include <pthread.h>
+#include <dirent.h>
+#include <fcntl.h>
+#include <grp.h>
+#include <pwd.h>
+#include <signal.h>
+
+#include <sys/types.h>
+#include <sys/ioctl.h>
+#include <sys/ipc.h>
+#include <sys/time.h>
+#include <sys/shm.h>
+#include <sys/socket.h>
+#include <sys/stat.h>
+#include <sys/wait.h>
+#include <netinet/in.h>
+
+#define QT_USE_XOPEN_LFS_EXTENSIONS
+#include "../common/posix/qplatformdefs.h"
+
+#undef QT_SOCKLEN_T
+
+#if defined(__GLIBC__) && (__GLIBC__ < 2)
+#define QT_SOCKLEN_T            int
+#else
+#define QT_SOCKLEN_T            socklen_t
+#endif
+
+#if defined(_XOPEN_SOURCE) && (_XOPEN_SOURCE >= 500)
+#define QT_SNPRINTF             ::snprintf
+#define QT_VSNPRINTF            ::vsnprintf
+#endif
+
+#endif // QPLATFORMDEFS_H
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/macx-clang/Info.plist.lib qt-everywhere-src-6.9.2/qtbase/mkspecs/macx-clang/Info.plist.lib
--- qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/macx-clang/Info.plist.lib	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/mkspecs/macx-clang/Info.plist.lib	2025-10-02 14:40:35.402129731 -0700
@@ -14,6 +14,30 @@
 	<string>${QMAKE_PKGINFO_TYPEINFO}</string>
 	<key>CFBundleVersion</key>
 	<string>${QMAKE_FULL_VERSION}</string>
+	<key>CFBundleSupportedPlatforms</key>
+	<array>
+		<string>MacOSX</string>
+	</array>
+	<key>CFBundleVersion</key>
+	<string>1.0</string>
+	<key>DTCompiler</key>
+	<string>com.apple.compilers.llvm.clang.1_0</string>
+	<key>DTPlatformBuild</key>
+	<string>12C33</string>
+	<key>DTPlatformName</key>
+	<string>macosx</string>
+	<key>DTPlatformVersion</key>
+	<string>11.1</string>
+	<key>DTSDKBuild</key>
+	<string>20C63</string>
+	<key>DTSDKName</key>
+	<string>macosx11.1</string>
+	<key>DTXcode</key>
+	<string>1230</string>
+	<key>DTXcodeBuild</key>
+	<string>12C33</string>
+	<key>LSMinimumSystemVersion</key>
+	<string>${MACOSX_DEPLOYMENT_TARGET}</string>
 	<key>NOTE</key>
 	<string>Please, do NOT change this file -- It was generated by Qt/QMake.</string>
 </dict>
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/macx-ios-clang/Info.plist.lib qt-everywhere-src-6.9.2/qtbase/mkspecs/macx-ios-clang/Info.plist.lib
--- qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/macx-ios-clang/Info.plist.lib	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/mkspecs/macx-ios-clang/Info.plist.lib	2025-10-02 14:40:35.402205724 -0700
@@ -14,6 +14,12 @@
 	<string>${QMAKE_PKGINFO_TYPEINFO}</string>
 	<key>CFBundleVersion</key>
 	<string>${QMAKE_FULL_VERSION}</string>
+	<key>CFBundleSupportedPlatforms</key>
+	<array>
+		<string>iPhoneOS</string>
+	</array>
+	<key>MinimumOSVersion</key>
+	<string>11.0</string>
 	<key>NOTE</key>
 	<string>Please, do NOT change this file -- It was generated by Qt/QMake.</string>
 </dict>
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/macx-tvos-clang/Info.plist.app qt-everywhere-src-6.9.2/qtbase/mkspecs/macx-tvos-clang/Info.plist.app
--- qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/macx-tvos-clang/Info.plist.app	1969-12-31 16:00:00.000000000 -0800
+++ qt-everywhere-src-6.9.2/qtbase/mkspecs/macx-tvos-clang/Info.plist.app	2025-10-02 14:40:35.402306624 -0700
@@ -0,0 +1,41 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
+<plist version="1.0">
+<dict>
+	<key>CFBundleDevelopmentRegion</key>
+	<string>en</string>
+	<key>CFBundleAllowMixedLocalizations</key>
+	<true/>
+	<key>CFBundleDisplayName</key>
+	<string>${PRODUCT_NAME}</string>
+	<key>CFBundleExecutable</key>
+	<string>${EXECUTABLE_NAME}</string>
+	<key>CFBundleIcons</key>
+	<dict>
+		<key>CFBundlePrimaryIcon</key>
+		<string>App Icon - Small</string>
+	</dict>
+	<key>CFBundleIdentifier</key>
+	<string>${PRODUCT_BUNDLE_IDENTIFIER}</string>
+	<key>CFBundleName</key>
+	<string>${PRODUCT_NAME}</string>
+	<key>CFBundlePackageType</key>
+	<string>APPL</string>
+	<key>CFBundleShortVersionString</key>
+	<string>${QMAKE_SHORT_VERSION}</string>
+	<key>CFBundleSignature</key>
+	<string>${QMAKE_PKGINFO_TYPEINFO}</string>
+	<key>CFBundleSupportedPlatforms</key>
+	<array>
+		<string>AppleTVOS</string>
+	</array>
+	<key>CFBundleVersion</key>
+	<string>${QMAKE_FULL_VERSION}</string>
+	<key>LSRequiresIPhoneOS</key>
+	<true/>
+	<key>MinimumOSVersion</key>
+	<string>${TVOS_DEPLOYMENT_TARGET}</string>
+	<key>NOTE</key>
+	<string>This file was generated by Qt/QMake.</string>
+</dict>
+</plist>
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/macx-tvos-clang/Info.plist.lib qt-everywhere-src-6.9.2/qtbase/mkspecs/macx-tvos-clang/Info.plist.lib
--- qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/macx-tvos-clang/Info.plist.lib	1969-12-31 16:00:00.000000000 -0800
+++ qt-everywhere-src-6.9.2/qtbase/mkspecs/macx-tvos-clang/Info.plist.lib	2025-10-02 14:40:35.402341330 -0700
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
+<plist version="1.0">
+<dict>
+	<key>CFBundleExecutable</key>
+	<string>${EXECUTABLE_NAME}</string>
+	<key>CFBundleIdentifier</key>
+	<string>${PRODUCT_BUNDLE_IDENTIFIER}</string>
+	<key>CFBundlePackageType</key>
+	<string>FMWK</string>
+	<key>CFBundleShortVersionString</key>
+	<string>${QMAKE_SHORT_VERSION}</string>
+	<key>CFBundleSignature</key>
+	<string>${QMAKE_PKGINFO_TYPEINFO}</string>
+	<key>CFBundleVersion</key>
+	<string>${QMAKE_FULL_VERSION}</string>
+	<key>NOTE</key>
+	<string>Please, do NOT change this file -- It was generated by Qt/QMake.</string>
+</dict>
+</plist>
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/macx-tvos-clang/qmake.conf qt-everywhere-src-6.9.2/qtbase/mkspecs/macx-tvos-clang/qmake.conf
--- qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/macx-tvos-clang/qmake.conf	1969-12-31 16:00:00.000000000 -0800
+++ qt-everywhere-src-6.9.2/qtbase/mkspecs/macx-tvos-clang/qmake.conf	2025-10-02 14:40:35.402381696 -0700
@@ -0,0 +1,19 @@
+#
+# qmake configuration for macx-tvos-clang
+#
+
+QMAKE_TVOS_DEPLOYMENT_TARGET    = 11.0
+
+QMAKE_APPLE_TARGETED_DEVICE_FAMILY = 3
+
+QMAKE_APPLE_DEVICE_ARCHS = arm64
+QMAKE_APPLE_SIMULATOR_ARCHS = x86_64
+
+include(../common/tvos.conf)
+include(../common/gcc-base-mac.conf)
+include(../common/clang.conf)
+include(../common/clang-mac.conf)
+include(../common/uikit/clang.conf)
+include(../common/uikit/qmake.conf)
+
+load(qt_config)
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/macx-tvos-clang/qplatformdefs.h qt-everywhere-src-6.9.2/qtbase/mkspecs/macx-tvos-clang/qplatformdefs.h
--- qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/macx-tvos-clang/qplatformdefs.h	1969-12-31 16:00:00.000000000 -0800
+++ qt-everywhere-src-6.9.2/qtbase/mkspecs/macx-tvos-clang/qplatformdefs.h	2025-10-02 14:40:35.402420449 -0700
@@ -0,0 +1,4 @@
+// Copyright (C) 2017 The Qt Company Ltd.
+// SPDX-License-Identifier: LicenseRef-Qt-Commercial OR LGPL-3.0-only OR GPL-2.0-only OR GPL-3.0-only
+
+#include "../common/mac/qplatformdefs.h"
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/unsupported/macx-tvos-clang/Info.plist.app qt-everywhere-src-6.9.2/qtbase/mkspecs/unsupported/macx-tvos-clang/Info.plist.app
--- qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/unsupported/macx-tvos-clang/Info.plist.app	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/mkspecs/unsupported/macx-tvos-clang/Info.plist.app	2025-10-02 14:40:35.402437140 -0700
@@ -1,41 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
-<plist version="1.0">
-<dict>
-	<key>CFBundleDevelopmentRegion</key>
-	<string>en</string>
-	<key>CFBundleAllowMixedLocalizations</key>
-	<true/>
-	<key>CFBundleDisplayName</key>
-	<string>${PRODUCT_NAME}</string>
-	<key>CFBundleExecutable</key>
-	<string>${EXECUTABLE_NAME}</string>
-	<key>CFBundleIcons</key>
-	<dict>
-		<key>CFBundlePrimaryIcon</key>
-		<string>App Icon - Small</string>
-	</dict>
-	<key>CFBundleIdentifier</key>
-	<string>${PRODUCT_BUNDLE_IDENTIFIER}</string>
-	<key>CFBundleName</key>
-	<string>${PRODUCT_NAME}</string>
-	<key>CFBundlePackageType</key>
-	<string>APPL</string>
-	<key>CFBundleShortVersionString</key>
-	<string>${QMAKE_SHORT_VERSION}</string>
-	<key>CFBundleSignature</key>
-	<string>${QMAKE_PKGINFO_TYPEINFO}</string>
-	<key>CFBundleSupportedPlatforms</key>
-	<array>
-		<string>AppleTVOS</string>
-	</array>
-	<key>CFBundleVersion</key>
-	<string>${QMAKE_FULL_VERSION}</string>
-	<key>LSRequiresIPhoneOS</key>
-	<true/>
-	<key>MinimumOSVersion</key>
-	<string>${TVOS_DEPLOYMENT_TARGET}</string>
-	<key>NOTE</key>
-	<string>This file was generated by Qt/QMake.</string>
-</dict>
-</plist>
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/unsupported/macx-tvos-clang/Info.plist.lib qt-everywhere-src-6.9.2/qtbase/mkspecs/unsupported/macx-tvos-clang/Info.plist.lib
--- qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/unsupported/macx-tvos-clang/Info.plist.lib	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/mkspecs/unsupported/macx-tvos-clang/Info.plist.lib	2025-10-02 14:40:35.402479019 -0700
@@ -1,20 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
-<plist version="1.0">
-<dict>
-	<key>CFBundleExecutable</key>
-	<string>${EXECUTABLE_NAME}</string>
-	<key>CFBundleIdentifier</key>
-	<string>${PRODUCT_BUNDLE_IDENTIFIER}</string>
-	<key>CFBundlePackageType</key>
-	<string>FMWK</string>
-	<key>CFBundleShortVersionString</key>
-	<string>${QMAKE_SHORT_VERSION}</string>
-	<key>CFBundleSignature</key>
-	<string>${QMAKE_PKGINFO_TYPEINFO}</string>
-	<key>CFBundleVersion</key>
-	<string>${QMAKE_FULL_VERSION}</string>
-	<key>NOTE</key>
-	<string>Please, do NOT change this file -- It was generated by Qt/QMake.</string>
-</dict>
-</plist>
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/unsupported/macx-tvos-clang/qmake.conf qt-everywhere-src-6.9.2/qtbase/mkspecs/unsupported/macx-tvos-clang/qmake.conf
--- qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/unsupported/macx-tvos-clang/qmake.conf	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/mkspecs/unsupported/macx-tvos-clang/qmake.conf	2025-10-02 14:40:35.402529585 -0700
@@ -1,19 +0,0 @@
-#
-# qmake configuration for macx-tvos-clang
-#
-
-QMAKE_TVOS_DEPLOYMENT_TARGET    = 13.0
-
-QMAKE_APPLE_TARGETED_DEVICE_FAMILY = 3
-
-QMAKE_APPLE_DEVICE_ARCHS = arm64
-QMAKE_APPLE_SIMULATOR_ARCHS = x86_64
-
-include(../common/tvos.conf)
-include(../common/gcc-base-mac.conf)
-include(../common/clang.conf)
-include(../common/clang-mac.conf)
-include(../common/uikit/clang.conf)
-include(../common/uikit/qmake.conf)
-
-load(qt_config)
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/unsupported/macx-tvos-clang/qplatformdefs.h qt-everywhere-src-6.9.2/qtbase/mkspecs/unsupported/macx-tvos-clang/qplatformdefs.h
--- qt-everywhere-src-6.9.2.orig/qtbase/mkspecs/unsupported/macx-tvos-clang/qplatformdefs.h	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/mkspecs/unsupported/macx-tvos-clang/qplatformdefs.h	2025-10-02 14:40:35.402575381 -0700
@@ -1,4 +0,0 @@
-// Copyright (C) 2017 The Qt Company Ltd.
-// SPDX-License-Identifier: LicenseRef-Qt-Commercial OR LGPL-3.0-only OR GPL-2.0-only OR GPL-3.0-only
-
-#include "../common/mac/qplatformdefs.h"
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/qmake/generators/mac/pbuilder_pbx.cpp qt-everywhere-src-6.9.2/qtbase/qmake/generators/mac/pbuilder_pbx.cpp
--- qt-everywhere-src-6.9.2.orig/qtbase/qmake/generators/mac/pbuilder_pbx.cpp	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/qmake/generators/mac/pbuilder_pbx.cpp	2025-10-02 14:40:35.402765890 -0700
@@ -1678,7 +1678,7 @@
                 if (!project->isEmpty("QMAKE_IOS_DEPLOYMENT_TARGET"))
                     t << "\t\t\t\t" << writeSettings("IPHONEOS_DEPLOYMENT_TARGET", project->first("QMAKE_IOS_DEPLOYMENT_TARGET")) << ";\n";
                 if (!project->isEmpty("QMAKE_TVOS_DEPLOYMENT_TARGET"))
-                    t << "\t\t\t\t" << writeSettings("APPLETVOS_DEPLOYMENT_TARGET", project->first("QMAKE_TVOS_DEPLOYMENT_TARGET")) << ";\n";
+                    t << "\t\t\t\t" << writeSettings("TVOS_DEPLOYMENT_TARGET", project->first("QMAKE_TVOS_DEPLOYMENT_TARGET")) << ";\n";
                 if (!project->isEmpty("QMAKE_WATCHOS_DEPLOYMENT_TARGET"))
                     t << "\t\t\t\t" << writeSettings("WATCHOS_DEPLOYMENT_TARGET", project->first("QMAKE_WATCHOS_DEPLOYMENT_TARGET")) << ";\n";
                 if (!project->isEmpty("QMAKE_VISIONOS_DEPLOYMENT_TARGET"))
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/qmake/library/proitems.h qt-everywhere-src-6.9.2/qtbase/qmake/library/proitems.h
--- qt-everywhere-src-6.9.2.orig/qtbase/qmake/library/proitems.h	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/qmake/library/proitems.h	2025-10-02 14:40:35.403018386 -0700
@@ -129,6 +129,7 @@
     qlonglong toLongLong(bool *ok = nullptr, int base = 10) const { return toQStringView().toLongLong(ok, base); }
     int toInt(bool *ok = nullptr, int base = 10) const { return toQStringView().toInt(ok, base); }
     short toShort(bool *ok = nullptr, int base = 10) const { return toQStringView().toShort(ok, base); }
+	float toFloat(bool *ok = nullptr) const { return toQStringView().toFloat(ok); }
 
     size_t hash() const { return m_hash; }
     static size_t hash(const QChar *p, int n);
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/qmake/library/qmakebuiltins.cpp qt-everywhere-src-6.9.2/qtbase/qmake/library/qmakebuiltins.cpp
--- qt-everywhere-src-6.9.2.orig/qtbase/qmake/library/qmakebuiltins.cpp	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/qmake/library/qmakebuiltins.cpp	2025-10-02 14:40:35.403163270 -0700
@@ -1658,6 +1658,15 @@
                 return returnBool(lhs_int < rhs_int);
             }
         }
+        float rhs_float = rhs.toFloat(&ok);
+        if (ok) { // do integer compare
+            float lhs_float = lhs.toFloat(&ok);
+            if (ok) {
+                if (func_t == T_GREATERTHAN)
+                    return returnBool(lhs_float > rhs_float);
+                return returnBool(lhs_float < rhs_float);
+            }
+        }
         if (func_t == T_GREATERTHAN)
             return returnBool(lhs > rhs.toQStringView());
         return returnBool(lhs < rhs.toQStringView());
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/corelib/CMakeLists.txt qt-everywhere-src-6.9.2/qtbase/src/corelib/CMakeLists.txt
--- qt-everywhere-src-6.9.2.orig/qtbase/src/corelib/CMakeLists.txt	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/corelib/CMakeLists.txt	2025-10-02 14:40:35.403366904 -0700
@@ -646,8 +646,6 @@
     LIBRARIES
         ${FWCoreFoundation}
         ${FWFoundation}
-    PUBLIC_LIBRARIES
-        ${FWIOKit}
     DEFINES
         _DARWIN_C_SOURCE    # This resolves two issues,
                             #   - Provide DT_* macros to qfilesystemengine_unix.cpp
@@ -677,6 +675,12 @@
         ${FWSecurity}
     PUBLIC_LIBRARIES
         ${FWDiskArbitration}
+        ${FWIOKit}
+)
+
+qt_internal_extend_target(Core CONDITION (IOS OR VISIONOS)
+    PUBLIC_LIBRARIES
+        ${FWIOKit}
 )
 
 qt_internal_extend_target(Core CONDITION INTEGRITY
@@ -1333,14 +1337,18 @@
     )
 
     # Contacts
-    qt_internal_extend_target(QDarwinContactsPermissionPlugin
-        LIBRARIES ${FWContacts}
-    )
+    if(NOT TVOS)
+        qt_internal_extend_target(QDarwinContactsPermissionPlugin
+            LIBRARIES ${FWContacts}
+        )
+    endif()
 
     # Calendar
-    qt_internal_extend_target(QDarwinCalendarPermissionPlugin
-        LIBRARIES ${FWEventKit}
-    )
+    if(NOT TVOS)
+        qt_internal_extend_target(QDarwinCalendarPermissionPlugin
+            LIBRARIES ${FWEventKit}
+        )
+    endif()
     set_property(TARGET QDarwinCalendarPermissionPlugin PROPERTY
         _qt_info_plist_usage_descriptions "NSCalendarsUsageDescription"
     )
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/corelib/configure.cmake qt-everywhere-src-6.9.2/qtbase/src/corelib/configure.cmake
--- qt-everywhere-src-6.9.2.orig/qtbase/src/corelib/configure.cmake	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/corelib/configure.cmake	2025-10-02 14:40:35.405779863 -0700
@@ -696,7 +696,7 @@
 )
 qt_feature("cxx17_filesystem" PUBLIC
     LABEL "C++17 <filesystem>"
-    CONDITION TEST_cxx17_filesystem
+    CONDITION TEST_cxx17_filesystem AND NOT IOS AND NOT TVOS
 )
 qt_feature("broken-threadlocal-dtors" PRIVATE
     LABEL "Broken execution of thread_local destructors at exit() time"
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/corelib/global/qcompilerdetection.h qt-everywhere-src-6.9.2/qtbase/src/corelib/global/qcompilerdetection.h
--- qt-everywhere-src-6.9.2.orig/qtbase/src/corelib/global/qcompilerdetection.h	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/corelib/global/qcompilerdetection.h	2025-10-02 14:40:35.405947219 -0700
@@ -632,10 +632,14 @@
 #    if __has_feature(cxx_alias_templates)
 #      define Q_COMPILER_TEMPLATE_ALIAS
 #    endif
-#    if __has_feature(cxx_thread_local)
-#      if !defined(__FreeBSD__) /* FreeBSD clang fails on __cxa_thread_atexit */
-#        define Q_COMPILER_THREAD_LOCAL
-#      endif
+#    if defined(Q_PROCESSOR_X86_64) && defined(__IPHONE_OS_VERSION_MIN_REQUIRED) && __IPHONE_OS_VERSION_MIN_REQUIRED < 90000 /* iOS simulator only supports thread local in iOS 9.0 and newer */
+#      define Q_COMPILER_THREAD_LOCAL_UNSUPPORTED
+#    endif
+#    if !defined(__FreeBSD__) /* FreeBSD clang fails on __cxa_thread_atexit */
+#      define Q_COMPILER_THREAD_LOCAL_UNSUPPORTED
+#    endif
+#    if __has_feature(cxx_thread_local) && !defined(Q_COMPILER_THREAD_LOCAL_UNSUPPORTED)
+#      define Q_COMPILER_THREAD_LOCAL
 #    endif
 #    if __has_feature(cxx_user_literals)
 #      define Q_COMPILER_UDL
@@ -772,6 +776,10 @@
 #         define Q_COMPILER_REF_QUALIFIERS
 #      endif
 #    endif
+#    if Q_CC_GNU >= 409
+       /* Marvell gcc 4.9 has support for constexpr, at least well enough to build Qt threads */
+#      define Q_COMPILER_PARTIAL_CONSTEXPR
+#    endif
 #    if Q_CC_GNU >= 500
        /* GCC 4.6 introduces constexpr, but it's bugged (at least) in the whole
         * 4.x series, see e.g. https://gcc.gnu.org/bugzilla/show_bug.cgi?id=57694 */
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/corelib/kernel/qcoreapplication.cpp qt-everywhere-src-6.9.2/qtbase/src/corelib/kernel/qcoreapplication.cpp
--- qt-everywhere-src-6.9.2.orig/qtbase/src/corelib/kernel/qcoreapplication.cpp	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/corelib/kernel/qcoreapplication.cpp	2025-10-02 14:40:35.406202160 -0700
@@ -178,7 +178,7 @@
 #ifdef QT_BOOTSTRAPPED
 #elif defined(Q_OS_DARWIN)
     applicationVersion = infoDictionaryStringProperty(QStringLiteral("CFBundleVersion"));
-#elif defined(Q_OS_ANDROID)
+#elif defined(Q_OS_ANDROID) && defined(Q_ANDROID_JNI_ENABLED)
     QJniObject context(QNativeInterface::QAndroidApplication::context());
     if (context.isValid()) {
         QJniObject pm = context.callObjectMethod(
@@ -450,6 +450,10 @@
 #  endif // Q_OS_UNIX
 
     QThread *cur = QThread::currentThread(); // note: this may end up setting theMainThread!
+    if (cur != theMainThread.loadAcquire()) {
+        QThreadData::resetMainThread();
+        cur = QThread::currentThread();
+    }
     if (cur != theMainThread.loadAcquire())
         qWarning("WARNING: QApplication was not created in the main() thread.");
 #endif
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/corelib/kernel/qcoreevent.h qt-everywhere-src-6.9.2/qtbase/src/corelib/kernel/qcoreevent.h
--- qt-everywhere-src-6.9.2.orig/qtbase/src/corelib/kernel/qcoreevent.h	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/corelib/kernel/qcoreevent.h	2025-10-02 14:40:35.406469694 -0700
@@ -300,6 +300,8 @@
         // 512 reserved for Qt Jambi's MetaCall event
         // 513 reserved for Qt Jambi's DeleteOnMainThread event
 
+        Controller = 768,                       // Game controller state change
+
         User = 1000,                            // first user event id
         MaxUser = 65535                         // last user event id
     };
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/corelib/kernel/qjnienvironment.cpp qt-everywhere-src-6.9.2/qtbase/src/corelib/kernel/qjnienvironment.cpp
--- qt-everywhere-src-6.9.2.orig/qtbase/src/corelib/kernel/qjnienvironment.cpp	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/corelib/kernel/qjnienvironment.cpp	2025-10-02 14:40:35.406586675 -0700
@@ -66,6 +66,9 @@
     JNIEnv *jniEnv = nullptr;
 
     JavaVM *vm = QtAndroidPrivate::javaVM();
+    if (!vm)
+        return;
+
     const jint ret = vm->GetEnv((void**)&jniEnv, JNI_VERSION_1_6);
 
     if (ret == JNI_EDETACHED) { // We need to (re-)attach
@@ -535,7 +538,7 @@
 */
 bool QJniEnvironment::checkAndClearExceptions(JNIEnv *env, QJniEnvironment::OutputMode outputMode)
 {
-    if (Q_UNLIKELY(env->ExceptionCheck())) {
+    if (env && Q_UNLIKELY(env->ExceptionCheck())) {
         if (outputMode == OutputMode::Verbose) {
             if (jthrowable exception = env->ExceptionOccurred()) {
                 env->ExceptionClear();
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/corelib/kernel/qjnihelpers.cpp qt-everywhere-src-6.9.2/qtbase/src/corelib/kernel/qjnihelpers.cpp
--- qt-everywhere-src-6.9.2.orig/qtbase/src/corelib/kernel/qjnihelpers.cpp	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/corelib/kernel/qjnihelpers.cpp	2025-10-02 14:40:35.406699097 -0700
@@ -456,6 +456,7 @@
 
 QT_END_NAMESPACE
 
+#if defined(Q_ANDROID_JNI_ENABLED)
 JNIEXPORT jint JNICALL JNI_OnLoad(JavaVM *vm, void *reserved)
 {
     Q_UNUSED(reserved);
@@ -490,3 +491,4 @@
 
     return JNI_VERSION_1_6;
 }
+#endif
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/corelib/kernel/qmath.h qt-everywhere-src-6.9.2/qtbase/src/corelib/kernel/qmath.h
--- qt-everywhere-src-6.9.2.orig/qtbase/src/corelib/kernel/qmath.h	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/corelib/kernel/qmath.h	2025-10-02 14:40:35.406804906 -0700
@@ -237,6 +237,8 @@
 #define M_SQRT1_2 (0.70710678118654752440)
 #endif
 
+#define _MATH_DEFINES_DEFINED
+
 inline qreal qFastSin(qreal x)
 {
     int si = int(x * (0.5 * QT_SINE_TABLE_SIZE / M_PI)); // Would be more accurate with qRound, but slower.
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/corelib/kernel/qobject.cpp qt-everywhere-src-6.9.2/qtbase/src/corelib/kernel/qobject.cpp
--- qt-everywhere-src-6.9.2.orig/qtbase/src/corelib/kernel/qobject.cpp	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/corelib/kernel/qobject.cpp	2025-10-02 14:40:35.407074164 -0700
@@ -1680,7 +1680,7 @@
     QThreadData *currentData = QThreadData::current();
     QThreadData *targetData = targetThread ? QThreadData::get2(targetThread) : nullptr;
     QThreadData *thisThreadData = d->threadData.loadAcquire();
-    if (!thisThreadData->thread.loadRelaxed() && currentData == targetData) {
+    if (/*!thisThreadData->thread.loadRelaxed() && */currentData == targetData) {
         // one exception to the rule: we allow moving objects with no thread affinity to the current thread
         currentData = thisThreadData;
     } else if (thisThreadData != currentData) {
@@ -1897,15 +1897,14 @@
         return 0;
     }
 
+    if (Q_UNLIKELY(thread() != QThread::currentThread())) {
+        moveToThread(QThread::currentThread());
+    }
     auto thisThreadData = d->threadData.loadRelaxed();
     if (Q_UNLIKELY(!thisThreadData->hasEventDispatcher())) {
         qWarning("QObject::startTimer: Timers can only be used with threads started with QThread");
         return 0;
     }
-    if (Q_UNLIKELY(thread() != QThread::currentThread())) {
-        qWarning("QObject::startTimer: Timers cannot be started from another thread");
-        return 0;
-    }
 
     auto dispatcher = thisThreadData->eventDispatcher.loadRelaxed();
     Qt::TimerId timerId = dispatcher->registerTimer(interval, timerType, this);
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/corelib/platform/darwin/qdarwinpermissionplugin_calendar.mm qt-everywhere-src-6.9.2/qtbase/src/corelib/platform/darwin/qdarwinpermissionplugin_calendar.mm
--- qt-everywhere-src-6.9.2.orig/qtbase/src/corelib/platform/darwin/qdarwinpermissionplugin_calendar.mm	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/corelib/platform/darwin/qdarwinpermissionplugin_calendar.mm	2025-10-02 14:40:35.407502962 -0700
@@ -3,6 +3,17 @@
 
 #include "qdarwinpermissionplugin_p_p.h"
 
+#ifdef Q_OS_TVOS
+
+@implementation QDarwinCalendarPermissionHandler
+- (Qt::PermissionStatus)checkPermission:(QPermission)permission
+{
+    return Qt::PermissionStatus::Denied;
+}
+@end
+
+#else
+
 #include <EventKit/EventKit.h>
 
 @interface QDarwinCalendarPermissionHandler ()
@@ -68,4 +79,6 @@
 
 @end
 
+#endif // Q_OS_TVOS
+
 #include "moc_qdarwinpermissionplugin_p_p.cpp"
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/corelib/platform/darwin/qdarwinpermissionplugin_camera.mm qt-everywhere-src-6.9.2/qtbase/src/corelib/platform/darwin/qdarwinpermissionplugin_camera.mm
--- qt-everywhere-src-6.9.2.orig/qtbase/src/corelib/platform/darwin/qdarwinpermissionplugin_camera.mm	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/corelib/platform/darwin/qdarwinpermissionplugin_camera.mm	2025-10-02 14:40:35.407580408 -0700
@@ -5,6 +5,17 @@
 
 #include <AVFoundation/AVFoundation.h>
 
+#ifdef Q_OS_TVOS
+
+@implementation QDarwinCameraPermissionHandler
+- (Qt::PermissionStatus)checkPermission:(QPermission)permission
+{
+    return Qt::PermissionStatus::Denied;
+}
+@end
+
+#else
+
 QT_DEFINE_PERMISSION_STATUS_CONVERTER(AVAuthorizationStatus);
 
 #ifndef BUILDING_PERMISSION_REQUEST
@@ -40,3 +51,5 @@
 @end
 
 #endif // BUILDING_PERMISSION_REQUEST
+
+#endif // Q_OS_TVOS
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/corelib/platform/darwin/qdarwinpermissionplugin_contacts.mm qt-everywhere-src-6.9.2/qtbase/src/corelib/platform/darwin/qdarwinpermissionplugin_contacts.mm
--- qt-everywhere-src-6.9.2.orig/qtbase/src/corelib/platform/darwin/qdarwinpermissionplugin_contacts.mm	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/corelib/platform/darwin/qdarwinpermissionplugin_contacts.mm	2025-10-02 14:40:35.407650471 -0700
@@ -3,6 +3,17 @@
 
 #include "qdarwinpermissionplugin_p_p.h"
 
+#ifdef Q_OS_TVOS
+
+@implementation QDarwinContactsPermissionHandler
+- (Qt::PermissionStatus)checkPermission:(QPermission)permission
+{
+    return Qt::PermissionStatus::Denied;
+}
+@end
+
+#else
+
 #include <Contacts/Contacts.h>
 
 @interface QDarwinContactsPermissionHandler ()
@@ -67,4 +78,6 @@
 
 @end
 
+#endif // Q_OS_TVOS
+
 #include "moc_qdarwinpermissionplugin_p_p.cpp"
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/corelib/platform/darwin/qdarwinpermissionplugin_location.mm qt-everywhere-src-6.9.2/qtbase/src/corelib/platform/darwin/qdarwinpermissionplugin_location.mm
--- qt-everywhere-src-6.9.2.orig/qtbase/src/corelib/platform/darwin/qdarwinpermissionplugin_location.mm	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/corelib/platform/darwin/qdarwinpermissionplugin_location.mm	2025-10-02 14:40:35.407721885 -0700
@@ -187,10 +187,12 @@
         // be called when the current authorization status is either undetermined,
         // or authorized when in use.
         switch ([self authorizationStatus]) {
+#ifndef Q_OS_TVOS
         case kCLAuthorizationStatusNotDetermined:
             [self.manager requestAlwaysAuthorization];
             break;
-#ifdef Q_OS_IOS
+#endif
+#if defined(Q_OS_IOS) || defined(Q_OS_TVOS)
         case kCLAuthorizationStatusAuthorizedWhenInUse:
             // Unfortunately when asking for AlwaysAuthorization when in
             // the WhenInUse state, to "upgrade" the permission, the iOS
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/corelib/platform/darwin/qdarwinpermissionplugin_microphone.mm qt-everywhere-src-6.9.2/qtbase/src/corelib/platform/darwin/qdarwinpermissionplugin_microphone.mm
--- qt-everywhere-src-6.9.2.orig/qtbase/src/corelib/platform/darwin/qdarwinpermissionplugin_microphone.mm	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/corelib/platform/darwin/qdarwinpermissionplugin_microphone.mm	2025-10-02 14:40:35.407802457 -0700
@@ -5,6 +5,17 @@
 
 #include <AVFoundation/AVFoundation.h>
 
+#ifdef Q_OS_TVOS
+
+@implementation QDarwinMicrophonePermissionHandler
+- (Qt::PermissionStatus)checkPermission:(QPermission)permission
+{
+    return Qt::PermissionStatus::Denied;
+}
+@end
+
+#else
+
 QT_DEFINE_PERMISSION_STATUS_CONVERTER(AVAuthorizationStatus);
 
 #ifndef BUILDING_PERMISSION_REQUEST
@@ -40,3 +51,5 @@
 @end
 
 #endif // BUILDING_PERMISSION_REQUEST
+
+#endif // Q_OS_TVOS
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/corelib/text/qbytearraymatcher.h qt-everywhere-src-6.9.2/qtbase/src/corelib/text/qbytearraymatcher.h
--- qt-everywhere-src-6.9.2.orig/qtbase/src/corelib/text/qbytearraymatcher.h	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/corelib/text/qbytearraymatcher.h	2025-10-02 14:40:35.407896194 -0700
@@ -5,6 +5,7 @@
 #define QBYTEARRAYMATCHER_H
 
 #include <QtCore/qbytearray.h>
+#include <limits>
 
 #include <QtCore/q20algorithm.h>
 #include <iterator>
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/corelib/thread/qthread.cpp qt-everywhere-src-6.9.2/qtbase/src/corelib/thread/qthread.cpp
--- qt-everywhere-src-6.9.2.orig/qtbase/src/corelib/thread/qthread.cpp	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/corelib/thread/qthread.cpp	2025-10-02 14:40:35.408009518 -0700
@@ -84,6 +84,12 @@
     return ed;
 }
 
+void QThreadData::resetMainThread()
+{
+    QCoreApplicationPrivate::theMainThread.storeRelease(nullptr);
+    clearCurrentThreadData();
+}
+
 /*
   QAdoptedThread
 */
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/corelib/thread/qthread_p.h qt-everywhere-src-6.9.2/qtbase/src/corelib/thread/qthread_p.h
--- qt-everywhere-src-6.9.2.orig/qtbase/src/corelib/thread/qthread_p.h	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/corelib/thread/qthread_p.h	2025-10-02 14:40:35.408155934 -0700
@@ -316,6 +316,7 @@
         return createCurrentThreadData();
     }
     static void clearCurrentThreadData();
+    static void resetMainThread();
     static QThreadData *get2(QThread *thread)
     { Q_ASSERT_X(thread != nullptr, "QThread", "internal error"); return thread->d_func()->data; }
 
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/gui/CMakeLists.txt qt-everywhere-src-6.9.2/qtbase/src/gui/CMakeLists.txt
--- qt-everywhere-src-6.9.2.orig/qtbase/src/gui/CMakeLists.txt	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/gui/CMakeLists.txt	2025-10-02 14:40:35.408269107 -0700
@@ -229,6 +229,7 @@
         painting/qtriangulatingstroker.cpp painting/qtriangulatingstroker_p.h
         painting/qtriangulator.cpp painting/qtriangulator_p.h
         painting/qvectorpath_p.h
+        platform/virtual/qvirtualplatform.h
         rhi/qrhi.cpp rhi/qrhi.h rhi/qrhi_platform.h rhi/qrhi_p.h
         rhi/qrhinull.cpp rhi/qrhinull_p.h
         rhi/qshader.cpp rhi/qshader.h rhi/qshader_p.h
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/gui/kernel/qevent.cpp qt-everywhere-src-6.9.2/qtbase/src/gui/kernel/qevent.cpp
--- qt-everywhere-src-6.9.2.orig/qtbase/src/gui/kernel/qevent.cpp	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/gui/kernel/qevent.cpp	2025-10-02 14:40:35.408504281 -0700
@@ -4880,6 +4880,70 @@
     addPoint(this, point);
 }
 
+/*!
+    Creates a new QControllerEvent.
+*/
+QControllerEvent::QControllerEvent()
+: QEvent(QEvent::Controller)
+{
+    m_type = NONE;
+    m_pressed = false;
+    m_angle = 0;
+    m_distance = 0;
+    m_direction = DIRECTION_CENTER;
+}
+
+/*!
+    Initialize a controller event as a button press
+*/
+void QControllerEvent::setButton(EventType button, bool pressed)
+{
+	m_type = button;
+	m_pressed = pressed;
+}
+
+/*!
+    Initialize a controller event as a dpad direction
+*/
+void QControllerEvent::setDPad(Direction direction)
+{
+    m_type = DPAD;
+    m_direction = direction;
+}
+
+/*!
+    Initialize a controller event as a thumbstick motion
+	The angle ranges from 0 to 2 * M_PI starting at the top and going clockwise.
+	The distance ranges from 0 to 1
+*/
+void QControllerEvent::setThumbstick(EventType thumbstick, qreal angle, qreal distance)
+{
+	m_type = thumbstick;
+    m_angle = angle;
+    m_distance = distance;
+
+    if (distance > 0.0) {
+        m_direction = DIRECTION_N;
+        qreal span = ((2 * M_PI)/8);
+        for (int i=0; i<8; ++i) {
+            if (angle >= ((i*span)-(span/2)) && angle <= ((i*span)+(span/2))) {
+                m_direction = (Direction)(1+i);
+                break;
+            }
+        }
+    }
+}
+
+/*!
+    Initialize a controller event as a trigger motion
+	The distance ranges from 0 to 1
+*/
+void QControllerEvent::setTrigger(EventType trigger, qreal distance)
+{
+	m_type = trigger;
+	m_distance = distance;
+}
+
 QT_END_NAMESPACE
 
 #include "moc_qevent.cpp"
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/gui/kernel/qevent.h qt-everywhere-src-6.9.2/qtbase/src/gui/kernel/qevent.h
--- qt-everywhere-src-6.9.2.orig/qtbase/src/gui/kernel/qevent.h	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/gui/kernel/qevent.h	2025-10-02 14:40:35.408809316 -0700
@@ -1035,6 +1035,122 @@
     QWindow *c;
 };
 
+class Q_GUI_EXPORT QControllerEvent : public QEvent
+{
+public:
+    enum EventType
+    {
+		NONE,
+        BUTTON_A,
+        BUTTON_B,
+        BUTTON_X,
+        BUTTON_Y,
+        BUTTON_BACK,
+        BUTTON_GUIDE,
+        BUTTON_START,
+        BUTTON_LEFTSTICK,
+        BUTTON_RIGHTSTICK,
+        BUTTON_LEFTSHOULDER,
+        BUTTON_RIGHTSHOULDER,
+        DPAD,
+        THUMBSTICK_LEFT,
+        THUMBSTICK_RIGHT,
+        TRIGGER_LEFT,
+        TRIGGER_RIGHT,
+    };
+
+    enum Direction
+    {
+        DIRECTION_CENTER,
+        DIRECTION_N,
+        DIRECTION_NE,
+        DIRECTION_E,
+        DIRECTION_SE,
+        DIRECTION_S,
+        DIRECTION_SW,
+        DIRECTION_W,
+        DIRECTION_NW,
+    };
+
+public:
+    QControllerEvent();
+
+	void setButton(EventType button, bool pressed);
+    void setDPad(Direction direction);
+    void setThumbstick(EventType thumbstick, qreal angle, qreal distance);
+    void setTrigger(EventType trigger, qreal distance);
+
+    EventType type() const { return m_type; }
+
+    bool isButton() const { return m_type >= BUTTON_A && m_type <= BUTTON_RIGHTSHOULDER; }
+    bool isButtonPress() const { return isButton() && m_pressed; }
+    bool isButtonRelease() const { return isButton() && !m_pressed; }
+
+    bool isButtonA() const { return m_type == BUTTON_A; }
+    bool isButtonAPress() const { return isButtonA() && m_pressed; }
+    bool isButtonARelease() const { return isButtonA() && !m_pressed; }
+
+    bool isButtonB() const { return m_type == BUTTON_B; }
+    bool isButtonBPress() const { return isButtonB() && m_pressed; }
+    bool isButtonBRelease() const { return isButtonB() && !m_pressed; }
+
+    bool isButtonX() const { return m_type == BUTTON_X; }
+    bool isButtonXPress() const { return isButtonX() && m_pressed; }
+    bool isButtonXRelease() const { return isButtonX() && !m_pressed; }
+
+    bool isButtonY() const { return m_type == BUTTON_Y; }
+    bool isButtonYPress() const { return isButtonY() && m_pressed; }
+    bool isButtonYRelease() const { return isButtonY() && !m_pressed; }
+
+    bool isButtonBack() const { return m_type == BUTTON_BACK; }
+    bool isButtonBackPress() const { return isButtonBack() && m_pressed; }
+    bool isButtonBackRelease() const { return isButtonBack() && !m_pressed; }
+
+    bool isButtonGuide() const { return m_type == BUTTON_GUIDE; }
+    bool isButtonGuidePress() const { return isButtonGuide() && m_pressed; }
+    bool isButtonGuideRelease() const { return isButtonGuide() && !m_pressed; }
+
+    bool isButtonStart() const { return m_type == BUTTON_START; }
+    bool isButtonStartPress() const { return isButtonStart() && m_pressed; }
+    bool isButtonStartRelease() const { return isButtonStart() && !m_pressed; }
+
+    bool isButtonLeftStick() const { return m_type == BUTTON_LEFTSTICK; }
+    bool isButtonLeftStickPress() const { return isButtonLeftStick() && m_pressed; }
+    bool isButtonLeftStickRelease() const { return isButtonLeftStick() && !m_pressed; }
+
+    bool isButtonRightStick() const { return m_type == BUTTON_RIGHTSTICK; }
+    bool isButtonRightStickPress() const { return isButtonRightStick() && m_pressed; }
+    bool isButtonRightStickRelease() const { return isButtonRightStick() && !m_pressed; }
+
+    bool isButtonLeftShoulder() const { return m_type == BUTTON_LEFTSHOULDER; }
+    bool isButtonLeftShoulderPress() const { return isButtonLeftShoulder() && m_pressed; }
+    bool isButtonLeftShoulderRelease() const { return isButtonLeftShoulder() && !m_pressed; }
+
+    bool isButtonRightShoulder() const { return m_type == BUTTON_RIGHTSHOULDER; }
+    bool isButtonRightShoulderPress() const { return isButtonRightShoulder() && m_pressed; }
+    bool isButtonRightShoulderRelease() const { return isButtonRightShoulder() && !m_pressed; }
+
+    bool isDPad() const { return m_type == DPAD; }
+    bool isThumbstick() const { return m_type == THUMBSTICK_LEFT || m_type == THUMBSTICK_RIGHT; }
+    bool isTrigger() const { return m_type == TRIGGER_LEFT || m_type == TRIGGER_RIGHT; }
+
+    qreal angle() const { return m_angle; }
+    qreal distance() const { return m_distance; }
+    Direction direction() const { return m_direction; }
+
+    bool isDirectionUp() const { return m_direction == DIRECTION_NW || m_direction == DIRECTION_N || m_direction == DIRECTION_NE; }
+    bool isDirectionDown() const { return m_direction == DIRECTION_SW || m_direction == DIRECTION_S || m_direction == DIRECTION_SE; }
+    bool isDirectionLeft() const { return m_direction == DIRECTION_NW || m_direction == DIRECTION_W || m_direction == DIRECTION_SW; }
+    bool isDirectionRight() const { return m_direction == DIRECTION_NE || m_direction == DIRECTION_E || m_direction == DIRECTION_SE; }
+
+private:
+    EventType m_type;
+    bool m_pressed;
+    qreal m_angle;
+    qreal m_distance;
+    Direction m_direction;
+};
+
 QT_END_NAMESPACE
 
 #endif // QEVENT_H
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/gui/kernel/qwindowsysteminterface.cpp qt-everywhere-src-6.9.2/qtbase/src/gui/kernel/qwindowsysteminterface.cpp
--- qt-everywhere-src-6.9.2.orig/qtbase/src/gui/kernel/qwindowsysteminterface.cpp	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/gui/kernel/qwindowsysteminterface.cpp	2025-10-02 14:40:35.408956243 -0700
@@ -727,10 +727,12 @@
     QHighDpiScaling::updateHighDpiScaling();
     screen->d_func()->updateGeometry();
 
-    emit qGuiApp->screenAdded(screen);
+    if (qGuiApp) {
+        emit qGuiApp->screenAdded(screen);
 
-    if (isPrimary)
-        emit qGuiApp->primaryScreenChanged(screen);
+        if (isPrimary)
+            emit qGuiApp->primaryScreenChanged(screen);
+    }
 }
 
 /*!
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/gui/painting/qpainter.cpp qt-everywhere-src-6.9.2/qtbase/src/gui/painting/qpainter.cpp
--- qt-everywhere-src-6.9.2.orig/qtbase/src/gui/painting/qpainter.cpp	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/gui/painting/qpainter.cpp	2025-10-02 14:40:35.409275855 -0700
@@ -7293,8 +7293,12 @@
     else
         engine.option.setAlignment(Qt::AlignLeft); // do not do alignment twice
 
-    if (!option && (tf & Qt::TextWrapAnywhere))
-        engine.option.setWrapMode(QTextOption::WrapAnywhere);
+    if (!option) {
+        if (tf & Qt::TextWrapAnywhere)
+            engine.option.setWrapMode(QTextOption::WrapAnywhere);
+        else if (tf & Qt::TextWordWrap)
+            engine.option.setWrapMode(QTextOption::WrapAtWordBoundaryOrAnywhere);
+    }
 
     if (tf & Qt::TextJustificationForced)
         engine.forceJustification = true;
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/gui/platform/virtual/qvirtualplatform.h qt-everywhere-src-6.9.2/qtbase/src/gui/platform/virtual/qvirtualplatform.h
--- qt-everywhere-src-6.9.2.orig/qtbase/src/gui/platform/virtual/qvirtualplatform.h	1969-12-31 16:00:00.000000000 -0800
+++ qt-everywhere-src-6.9.2/qtbase/src/gui/platform/virtual/qvirtualplatform.h	2025-10-02 14:40:35.409738518 -0700
@@ -0,0 +1,75 @@
+/****************************************************************************
+**
+** Copyright (C) 2016 LG Electronics Ltd, author: mikko.levonmaa@lge.com
+** Contact: https://www.qt.io/licensing/
+**
+** This file is part of the plugins of the Qt Toolkit.
+**
+** $QT_BEGIN_LICENSE:LGPL$
+** Commercial License Usage
+** Licensees holding valid commercial Qt licenses may use this file in
+** accordance with the commercial license agreement provided with the
+** Software or, alternatively, in accordance with the terms contained in
+** a written agreement between you and The Qt Company. For licensing terms
+** and conditions see https://www.qt.io/terms-conditions. For further
+** information use the contact form at https://www.qt.io/contact-us.
+**
+** GNU Lesser General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU Lesser
+** General Public License version 3 as published by the Free Software
+** Foundation and appearing in the file LICENSE.LGPL3 included in the
+** packaging of this file. Please review the following information to
+** ensure the GNU Lesser General Public License version 3 requirements
+** will be met: https://www.gnu.org/licenses/lgpl-3.0.html.
+**
+** GNU General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU
+** General Public License version 2.0 or (at your option) the GNU General
+** Public license version 3 or any later version approved by the KDE Free
+** Qt Foundation. The licenses are as published by the Free Software
+** Foundation and appearing in the file LICENSE.GPL2 and LICENSE.GPL3
+** included in the packaging of this file. Please review the following
+** information to ensure the GNU General Public License requirements will
+** be met: https://www.gnu.org/licenses/gpl-2.0.html and
+** https://www.gnu.org/licenses/gpl-3.0.html.
+**
+** $QT_END_LICENSE$
+**
+****************************************************************************/
+
+#ifndef QVIRTUALPLATFORM_H
+#define QVIRTUALPLATFORM_H
+
+#include <QtCore/QByteArray>
+#include <QtGui/QGuiApplication>
+
+QT_BEGIN_NAMESPACE
+
+class QVirtualWindowDelegate {
+public:
+    virtual void release() = 0;
+    virtual void setGeometry(const QRect &rect) = 0;
+    virtual void setVisible(bool visible) = 0;
+    virtual void setWindowFlags(Qt::WindowFlags flags) = 0;
+    virtual void setWindowState(Qt::WindowStates state) = 0;
+    virtual void setWindowTitle(const QString &title) = 0;
+    virtual void setWindowIcon(const QIcon &icon) = 0;
+    virtual void flush(QWindow *window, QImage *image, const QRegion &region, const QPoint &offset) = 0;
+};
+
+class QVirtualPlatformDelegate {
+public:
+    virtual void release() = 0;
+    virtual QVirtualWindowDelegate *createWindowDelegate(QWindow *window) = 0;
+};
+
+class QVirtualPlatform {
+public:
+    virtual void setPlatformDelegate(QVirtualPlatformDelegate *delegate) = 0;
+    virtual void createScreen(QRect geometry) = 0;
+};
+
+QT_END_NAMESPACE
+
+#endif // QVIRTUALPLATFORM_H
+
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/network/kernel/qnetworkproxy_darwin.cpp qt-everywhere-src-6.9.2/qtbase/src/network/kernel/qnetworkproxy_darwin.cpp
--- qt-everywhere-src-6.9.2.orig/qtbase/src/network/kernel/qnetworkproxy_darwin.cpp	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/network/kernel/qnetworkproxy_darwin.cpp	2025-10-02 14:40:35.409802338 -0700
@@ -53,7 +53,7 @@
     if (host.isEmpty())
         return true;
 
-#ifndef Q_OS_IOS
+#if !defined(Q_OS_IOS) && !defined(Q_OS_TVOS)
     // On iOS all those keys are not available, and worse so - entries
     // for HTTPS are not in the dictionary, but instead in some nested dictionary
     // with undocumented keys/object types.
@@ -187,7 +187,7 @@
     return escaped.toCFString();
 }
 
-#ifdef Q_OS_IOS
+#if defined(Q_OS_IOS) || defined(Q_OS_TVOS)
 QList<QNetworkProxy> proxiesForQueryUrl(CFDictionaryRef dict, const QUrl &url)
 {
     Q_ASSERT(dict);
@@ -301,7 +301,7 @@
     }
 
 
-#ifdef Q_OS_IOS
+#if defined(Q_OS_IOS) || defined(Q_OS_TVOS)
     if (protocolSpecificProxy.type() != QNetworkProxy::DefaultProxy
         && protocolSpecificProxy.type() != QNetworkProxy::DefaultProxy) {
         // HTTP proxy is enabled (on iOS there is no separate HTTPS, though
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/platformsupport/input/evdevmouse/qevdevmousemanager.cpp qt-everywhere-src-6.9.2/qtbase/src/platformsupport/input/evdevmouse/qevdevmousemanager.cpp
--- qt-everywhere-src-6.9.2.orig/qtbase/src/platformsupport/input/evdevmouse/qevdevmousemanager.cpp	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/platformsupport/input/evdevmouse/qevdevmousemanager.cpp	2025-10-02 14:40:35.409916063 -0700
@@ -15,15 +15,19 @@
 #include <private/qinputdevicemanager_p_p.h>
 #include <private/qhighdpiscaling_p.h>
 
+#define ENV_READ_THROTTLE_RATE 10
+
 QT_BEGIN_NAMESPACE
 
 using namespace Qt::StringLiterals;
 
 QEvdevMouseManager::QEvdevMouseManager(const QString &key, const QString &specification, QObject *parent)
-    : QObject(parent), m_x(0), m_y(0), m_xoffset(0), m_yoffset(0)
+    : QObject(parent), m_x(0), m_y(0), m_xoffset(0), m_yoffset(0), m_envReadThrottle(0), m_sensitivity(1.0f), m_accum_x(0.0f), m_accum_y(0.0f)
 {
     Q_UNUSED(key);
 
+    readMouseParamsFromEnv();
+
     QString spec = qEnvironmentVariable("QT_QPA_EVDEV_MOUSE_PARAMETERS");
 
     if (spec.isEmpty())
@@ -87,13 +91,30 @@
         m_y = g.bottom() - m_yoffset;
 }
 
+static int
+GetScaledMouseDelta(float scale, int value, float *accum)
+{
+    if (scale != 1.0f) {
+        *accum += scale * value;
+        if (*accum >= 0.0f) {
+            value = (int)floorf(*accum);
+        } else {
+            value = (int)ceilf(*accum);
+        }
+        *accum -= value;
+    }
+    return value;
+}
+
 void QEvdevMouseManager::handleMouseEvent(int x, int y, bool abs, Qt::MouseButtons buttons,
                                           Qt::MouseButton button, QEvent::Type type)
 {
+    readMouseParamsFromEnv();
+
     // update current absolute coordinates
     if (!abs) {
-        m_x += x;
-        m_y += y;
+        m_x += GetScaledMouseDelta(m_sensitivity, x, &m_accum_x);
+        m_y += GetScaledMouseDelta(m_sensitivity, y, &m_accum_y);
     } else {
         m_x = x;
         m_y = y;
@@ -143,4 +164,36 @@
         QInputDeviceManager::DeviceTypePointer, m_mice.count());
 }
 
+void QEvdevMouseManager::readMouseParamsFromEnv()
+{
+    if (m_envReadThrottle++ % ENV_READ_THROTTLE_RATE)
+        return;
+
+    QString spec = QString::fromLocal8Bit(qgetenv("QT_QPA_EVDEV_MOUSE_PARAMETERS"));
+
+    if (spec.isEmpty() || m_lastEnvSpec == spec)
+        return;
+
+    m_lastEnvSpec = spec;
+
+    QStringList args = spec.split(QLatin1Char(':'));
+
+    for (const QString &arg : args) {
+        if (arg.startsWith(QLatin1String("/dev/"))) {
+            args.removeAll(arg);
+        } else if (arg.startsWith(QLatin1String("xoffset="))) {
+            m_xoffset = arg.mid(8).toInt();
+        } else if (arg.startsWith(QLatin1String("yoffset="))) {
+            m_yoffset = arg.mid(8).toInt();
+        } else if (arg.startsWith(QLatin1String("sensitivity="))) {
+            m_sensitivity = arg.mid(12).toFloat();
+            if (m_sensitivity <= 0.0f)
+                m_sensitivity = 1.0f;
+        }
+    }
+
+    // build new specification without /dev/ elements
+    m_spec = args.join(QLatin1Char(':'));
+}
+
 QT_END_NAMESPACE
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/platformsupport/input/evdevmouse/qevdevmousemanager_p.h qt-everywhere-src-6.9.2/qtbase/src/platformsupport/input/evdevmouse/qevdevmousemanager_p.h
--- qt-everywhere-src-6.9.2.orig/qtbase/src/platformsupport/input/evdevmouse/qevdevmousemanager_p.h	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/platformsupport/input/evdevmouse/qevdevmousemanager_p.h	2025-10-02 14:40:35.409995041 -0700
@@ -42,6 +42,9 @@
     void removeMouse(const QString &deviceNode);
 
 private:
+    void readMouseParamsFromEnv();
+
+private:
     void clampPosition();
     void updateDeviceCount();
 
@@ -51,6 +54,11 @@
     int m_y;
     int m_xoffset;
     int m_yoffset;
+    QString m_lastEnvSpec;
+    unsigned int m_envReadThrottle;
+    float m_sensitivity;
+    float m_accum_x;
+    float m_accum_y;
 };
 
 QT_END_NAMESPACE
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/imageformats/gif/CMakeLists.txt qt-everywhere-src-6.9.2/qtbase/src/plugins/imageformats/gif/CMakeLists.txt
--- qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/imageformats/gif/CMakeLists.txt	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/plugins/imageformats/gif/CMakeLists.txt	2025-10-02 14:40:35.410073039 -0700
@@ -7,6 +7,7 @@
 
 qt_internal_add_plugin(QGifPlugin
     OUTPUT_NAME qgif
+    STATIC
     PLUGIN_TYPE imageformats
     SOURCES
         main.cpp
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/imageformats/jpeg/CMakeLists.txt qt-everywhere-src-6.9.2/qtbase/src/plugins/imageformats/jpeg/CMakeLists.txt
--- qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/imageformats/jpeg/CMakeLists.txt	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/plugins/imageformats/jpeg/CMakeLists.txt	2025-10-02 14:40:35.410164681 -0700
@@ -9,6 +9,7 @@
 
 qt_internal_add_plugin(QJpegPlugin
     OUTPUT_NAME qjpeg
+    STATIC
     PLUGIN_TYPE imageformats
     SOURCES
         main.cpp
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/platforms/CMakeLists.txt qt-everywhere-src-6.9.2/qtbase/src/plugins/platforms/CMakeLists.txt
--- qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/platforms/CMakeLists.txt	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/plugins/platforms/CMakeLists.txt	2025-10-02 14:40:35.410251435 -0700
@@ -56,3 +56,4 @@
 if(QT_FEATURE_vkkhrdisplay)
     add_subdirectory(vkkhrdisplay)
 endif()
+add_subdirectory(virtual)
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/platforms/eglfs/deviceintegration/eglfs_kms/qeglfskmsgbmintegration.cpp qt-everywhere-src-6.9.2/qtbase/src/plugins/platforms/eglfs/deviceintegration/eglfs_kms/qeglfskmsgbmintegration.cpp
--- qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/platforms/eglfs/deviceintegration/eglfs_kms/qeglfskmsgbmintegration.cpp	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/plugins/platforms/eglfs/deviceintegration/eglfs_kms/qeglfskmsgbmintegration.cpp	2025-10-02 14:40:35.410341485 -0700
@@ -13,6 +13,7 @@
 #include <QtCore/QLoggingCategory>
 #include <QtGui/QScreen>
 #include <QtDeviceDiscoverySupport/private/qdevicediscovery_p.h>
+#include <QtCore/private/qcore_unix_p.h>
 
 #include <gbm.h>
 
@@ -92,6 +93,27 @@
     screen->flip();
 }
 
+static bool validDevicePath(const QString &path)
+{
+    int fd = qt_safe_open(path.toLocal8Bit().constData(), O_RDWR | O_CLOEXEC);
+    if (fd < 0) {
+        qCDebug(qLcEglfsKmsDebug) << "Couldn't open" << path;
+        return false;
+    }
+
+    bool valid = false;
+    drmModeResPtr res = drmModeGetResources(fd);
+    if (res) {
+        valid = true;
+        drmModeFreeResources(res);
+    } else {
+        qCDebug(qLcEglfsKmsDebug) << "drmModeGetResources(" << path << ") failed:" << strerror(errno);
+    }
+    qt_safe_close(fd);
+
+    return valid;
+}
+
 QKmsDevice *QEglFSKmsGbmIntegration::createDevice()
 {
     QString path = screenConfig()->devicePath();
@@ -103,10 +125,16 @@
         qCDebug(qLcEglfsKmsDebug) << "Found the following video devices:" << devices;
         d->deleteLater();
 
-        if (Q_UNLIKELY(devices.isEmpty()))
+        for (QString candidate : devices) {
+            if (validDevicePath(candidate)) {
+                path = candidate;
+                break;
+            }
+        }
+
+        if (Q_UNLIKELY(path.isEmpty()))
             qFatal("Could not find DRM device!");
 
-        path = devices.first();
         qCDebug(qLcEglfsKmsDebug) << "Using" << path;
     }
 
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/platforms/ios/qiosintegration.mm qt-everywhere-src-6.9.2/qtbase/src/plugins/platforms/ios/qiosintegration.mm
--- qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/platforms/ios/qiosintegration.mm	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/plugins/platforms/ios/qiosintegration.mm	2025-10-02 14:40:35.410442165 -0700
@@ -246,8 +246,9 @@
         // this number is based on timing the native delay
         // since there is no API to get it
         return 2000;
-    case ShowIsMaximized:
-        return true;
+// Don't show dialogs maximized over other windows
+//    case ShowIsMaximized:
+//        return true;
     case SetFocusOnTouchRelease:
         return true;
     default:
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/platforms/ios/qiosscreen.mm qt-everywhere-src-6.9.2/qtbase/src/plugins/platforms/ios/qiosscreen.mm
--- qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/platforms/ios/qiosscreen.mm	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/plugins/platforms/ios/qiosscreen.mm	2025-10-02 14:40:35.410545800 -0700
@@ -67,10 +67,12 @@
 + (void)load
 {
     NSNotificationCenter *center = [NSNotificationCenter defaultCenter];
+#if 0 // We don't use this notification and it crashes once Qt app has quit
     [center addObserver:self selector:@selector(screenConnected:)
             name:UIScreenDidConnectNotification object:nil];
     [center addObserver:self selector:@selector(screenDisconnected:)
             name:UIScreenDidDisconnectNotification object:nil];
+#endif
     [center addObserver:self selector:@selector(screenModeChanged:)
             name:UIScreenModeDidChangeNotification object:nil];
 }
@@ -102,7 +104,9 @@
     QIOSScreen *screen = qtPlatformScreenFor([notification object]);
     Q_ASSERT_X(screen, Q_FUNC_INFO, "Screen changed that we didn't know about");
 
-    screen->updateProperties();
+    if (screen) {
+        screen->updateProperties();
+    }
 }
 
 @end
@@ -217,8 +221,12 @@
     QRect previousAvailableGeometry = m_availableGeometry;
 
 #if defined(Q_OS_VISIONOS)
-    // Based on what iPad app reports
     m_geometry = QRectF::fromCGRect(rootViewForScreen(this).bounds).toRect();
+    if (m_geometry.isEmpty()) {
+        m_geometry.setRect( 0.0, 0.0, 1280.0, 720.0);
+    }
+    static const qreal millimetersPerInch = 25.4;
+    m_physicalSize = m_geometry.size() * devicePixelRatio() / 132 * millimetersPerInch;
     m_depth = 24;
 #else
     m_geometry = QRectF::fromCGRect(m_uiScreen.bounds).toRect();
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/platforms/ios/qiostheme.mm qt-everywhere-src-6.9.2/qtbase/src/plugins/platforms/ios/qiostheme.mm
--- qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/platforms/ios/qiostheme.mm	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/plugins/platforms/ios/qiostheme.mm	2025-10-02 14:40:35.410653363 -0700
@@ -39,11 +39,13 @@
 {
     initializeSystemPalette();
 
+#ifndef Q_OS_TVOS
     m_contentSizeCategoryObserver = QMacNotificationObserver(nil,
         UIContentSizeCategoryDidChangeNotification, [] {
         qCDebug(lcQpaFonts) << "Contents size category changed to" << UIApplication.sharedApplication.preferredContentSizeCategory;
         QPlatformFontDatabase::repopulateFontDatabase();
     });
+#endif
 }
 
 QIOSTheme::~QIOSTheme()
@@ -54,6 +56,7 @@
 
 void QIOSTheme::initializeSystemPalette()
 {
+#ifndef Q_OS_TVOS
     Q_DECL_IMPORT QPalette qt_fusionPalette(void);
     s_systemPalette = qt_fusionPalette();
 
@@ -77,6 +80,7 @@
 
     if (@available(ios 15.0, *))
         s_systemPalette.setBrush(QPalette::Accent, qt_mac_toQBrush(UIColor.tintColor.CGColor));
+#endif // Q_OS_TVOS
 }
 
 const QPalette *QIOSTheme::palette(QPlatformTheme::Palette type) const
@@ -114,7 +118,7 @@
 QPlatformDialogHelper *QIOSTheme::createPlatformDialogHelper(QPlatformTheme::DialogType type) const
 {
     switch (type) {
-#ifndef Q_OS_TVOS
+#ifdef USE_NATIVE_DIALOGS
     case FileDialog:
         return new QIOSFileDialog();
         break;
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/platforms/ios/quiview_accessibility.mm qt-everywhere-src-6.9.2/qtbase/src/plugins/platforms/ios/quiview_accessibility.mm
--- qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/platforms/ios/quiview_accessibility.mm	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/plugins/platforms/ios/quiview_accessibility.mm	2025-10-02 14:40:35.410964039 -0700
@@ -44,10 +44,12 @@
     if ([m_accessibleElements count])
         return;
 
-    QWindow *win = self.platformWindow->window();
-    QAccessibleInterface *iface = win->accessibleRoot();
-    if (iface)
-        [self createAccessibleContainer: iface];
+    if (self.platformWindow) {
+        QWindow *win = self.platformWindow->window();
+        QAccessibleInterface *iface = win->accessibleRoot();
+        if (iface)
+            [self createAccessibleContainer: iface];
+    }
 }
 
 - (void)clearAccessibleCache
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/platforms/ios/quiview.h qt-everywhere-src-6.9.2/qtbase/src/plugins/platforms/ios/quiview.h
--- qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/platforms/ios/quiview.h	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/plugins/platforms/ios/quiview.h	2025-10-02 14:40:35.410742020 -0700
@@ -21,6 +21,9 @@
 - (void)sendUpdatedExposeEvent;
 - (BOOL)isActiveWindow;
 - (bool)handlePresses:(NSSet<UIPress *> *)presses eventType:(QEvent::Type)type;
+#ifdef Q_OS_TVOS
+- (void)swipeGesture:(UISwipeGestureRecognizer *)gesture;
+#endif
 @property (nonatomic, assign) QT_PREPEND_NAMESPACE(QIOSWindow) *platformWindow;
 @end
 
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/platforms/ios/quiview.mm qt-everywhere-src-6.9.2/qtbase/src/plugins/platforms/ios/quiview.mm
--- qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/platforms/ios/quiview.mm	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/plugins/platforms/ios/quiview.mm	2025-10-02 14:40:35.410836228 -0700
@@ -91,10 +91,12 @@
         // handled by the UIView. Scroll gestures, even those coming from touch devices,
         // such as trackpads will still be received as they are not touch events
         m_scrollGestureRecognizer.allowedTouchTypes = [NSArray array];
+#ifndef Q_OS_TVOS
         if (@available(ios 13.4, *)) {
             m_scrollGestureRecognizer.allowedScrollTypesMask = UIScrollTypeMaskAll;
         }
         m_scrollGestureRecognizer.maximumNumberOfTouches = 0;
+#endif
         m_lastScrollDelta = CGPointZero;
         m_lastScrollCursorPos = CGPointZero;
         [self addGestureRecognizer:m_scrollGestureRecognizer];
@@ -325,7 +327,7 @@
 
 - (BOOL)isActiveWindow
 {
-    // Normally this is determined exclusivly by being firstResponder, but
+    // Normally this is determined exclusively by being firstResponder, but
     // since we employ a separate first responder for text input we need to
     // handle both cases as this view being the active Qt window.
 
@@ -583,7 +585,12 @@
     case UIPressTypeSelect: return Qt::Key_Select;
     case UIPressTypeMenu: return Qt::Key_Menu;
     case UIPressTypePlayPause: return Qt::Key_MediaTogglePlayPause;
+#ifdef Q_OS_TVOS
+    case UIPressTypePageUp: return Qt::Key_PageUp;
+    case UIPressTypePageDown: return Qt::Key_PageDown;
+#endif
     }
+#ifndef Q_OS_TVOS
     if (@available(ios 13.4, *)) {
         NSString *charactersIgnoringModifiers = press.key.charactersIgnoringModifiers;
         Qt::Key key = QAppleKeyMapper::fromUIKitKey(charactersIgnoringModifiers);
@@ -592,6 +599,7 @@
         return QAppleKeyMapper::fromNSString(qtModifiers, press.key.characters,
                                              charactersIgnoringModifiers, text);
     }
+#endif
     return Qt::Key_unknown;
 }
 
@@ -624,8 +632,10 @@
 
     for (UIPress* press in presses) {
         Qt::KeyboardModifiers qtModifiers = Qt::NoModifier;
+#ifndef Q_OS_TVOS
         if (@available(ios 13.4, *))
             qtModifiers = QAppleKeyMapper::fromUIKitModifiers(press.key.modifierFlags);
+#endif
         QString text;
         int key = [self mapPressTypeToKey:press withModifiers:qtModifiers text:text];
         if (key == Qt::Key_unknown)
@@ -661,6 +671,33 @@
     [super pressesEnded:presses withEvent:event];
 }
 
+#ifdef Q_OS_TVOS
+- (void)swipeGesture:(UISwipeGestureRecognizer *)gesture
+{
+    if (gesture.state == UIGestureRecognizerStateEnded) {
+		int key = Qt::Key_unknown;
+		switch (gesture.direction) {
+		case UISwipeGestureRecognizerDirectionUp:
+			key = Qt::Key_Up;
+			break;
+		case UISwipeGestureRecognizerDirectionDown:
+			key = Qt::Key_Down;
+			break;
+		case UISwipeGestureRecognizerDirectionLeft:
+			key = Qt::Key_Left;
+			break;
+		case UISwipeGestureRecognizerDirectionRight:
+			key = Qt::Key_Right;
+			break;
+		default:
+			return;
+        }
+        QWindowSystemInterface::handleKeyEvent(self.platformWindow->window(), QEvent::KeyPress, key, Qt::NoModifier);
+        QWindowSystemInterface::handleKeyEvent(self.platformWindow->window(), QEvent::KeyRelease, key, Qt::NoModifier);
+    }
+}
+#endif // Q_OS_TVOS
+
 - (BOOL)canPerformAction:(SEL)action withSender:(id)sender
 {
 #if !defined(Q_OS_TVOS) && !defined(Q_OS_VISIONOS)
@@ -734,8 +771,11 @@
     ulong qt_timestamp = time_stamp * 1000;
 
     Qt::KeyboardModifiers qt_modifierFlags = Qt::NoModifier;
+
+#ifndef Q_OS_TVOS
     if (@available(ios 13.4, *))
         qt_modifierFlags = QAppleKeyMapper::fromUIKitModifiers(recognizer.modifierFlags);
+#endif
 
     if (recognizer.state == UIGestureRecognizerStateBegan)
         // locationInView: doesn't return the cursor position at the time of the wheel event,
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/platforms/virtual/CMakeLists.txt qt-everywhere-src-6.9.2/qtbase/src/plugins/platforms/virtual/CMakeLists.txt
--- qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/platforms/virtual/CMakeLists.txt	1969-12-31 16:00:00.000000000 -0800
+++ qt-everywhere-src-6.9.2/qtbase/src/plugins/platforms/virtual/CMakeLists.txt	2025-10-02 14:40:35.411071071 -0700
@@ -0,0 +1,34 @@
+# Copyright (C) 2022 The Qt Company Ltd.
+# SPDX-License-Identifier: BSD-3-Clause
+
+#####################################################################
+## QVirtualIntegrationPlugin Plugin:
+#####################################################################
+
+qt_find_package(WrapFreetype PROVIDED_TARGETS WrapFreetype::WrapFreetype)
+
+qt_internal_add_plugin(QVirtualIntegrationPlugin
+    OUTPUT_NAME qvirtual
+    PLUGIN_TYPE platforms
+    DEFAULT_IF ${QT_QPA_DEFAULT_PLATFORM} MATCHES virtual
+    SOURCES
+        main.cpp
+        qvirtualbackingstore.cpp qvirtualbackingstore.h
+        qvirtualintegration.cpp qvirtualintegration.h
+        qvirtualnativeinterface.cpp qvirtualnativeinterface.h
+    DEFINES
+        QT_NO_FOREACH
+    LIBRARIES
+        Qt::Core
+        Qt::CorePrivate
+        Qt::Gui
+        Qt::GuiPrivate
+)
+
+## Scopes:
+#####################################################################
+
+qt_internal_extend_target(QVirtualIntegrationPlugin CONDITION QT_FEATURE_freetype
+    LIBRARIES
+        WrapFreetype::WrapFreetype
+)
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/platforms/virtual/main.cpp qt-everywhere-src-6.9.2/qtbase/src/plugins/platforms/virtual/main.cpp
--- qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/platforms/virtual/main.cpp	1969-12-31 16:00:00.000000000 -0800
+++ qt-everywhere-src-6.9.2/qtbase/src/plugins/platforms/virtual/main.cpp	2025-10-02 14:40:35.411115615 -0700
@@ -0,0 +1,30 @@
+// Copyright (C) 2016 The Qt Company Ltd.
+// SPDX-License-Identifier: LicenseRef-Qt-Commercial OR LGPL-3.0-only OR GPL-2.0-only OR GPL-3.0-only
+
+
+#include <qpa/qplatformintegrationplugin.h>
+#include "qvirtualintegration.h"
+
+QT_BEGIN_NAMESPACE
+
+using namespace Qt::StringLiterals;
+
+class QVirtualIntegrationPlugin : public QPlatformIntegrationPlugin
+{
+    Q_OBJECT
+    Q_PLUGIN_METADATA(IID QPlatformIntegrationFactoryInterface_iid FILE "virtual.json")
+public:
+    QPlatformIntegration *create(const QString&, const QStringList&) override;
+};
+
+QPlatformIntegration *QVirtualIntegrationPlugin::create(const QString& system, const QStringList& paramList)
+{
+    if (!system.compare("virtual"_L1, Qt::CaseInsensitive))
+        return new QVirtualIntegration(paramList);
+
+    return nullptr;
+}
+
+QT_END_NAMESPACE
+
+#include "main.moc"
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/platforms/virtual/qvirtualbackingstore.cpp qt-everywhere-src-6.9.2/qtbase/src/plugins/platforms/virtual/qvirtualbackingstore.cpp
--- qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/platforms/virtual/qvirtualbackingstore.cpp	1969-12-31 16:00:00.000000000 -0800
+++ qt-everywhere-src-6.9.2/qtbase/src/plugins/platforms/virtual/qvirtualbackingstore.cpp	2025-10-02 14:40:35.411163004 -0700
@@ -0,0 +1,42 @@
+// Copyright (C) 2016 The Qt Company Ltd.
+// SPDX-License-Identifier: LicenseRef-Qt-Commercial OR LGPL-3.0-only OR GPL-2.0-only OR GPL-3.0-only
+
+
+#include "qvirtualbackingstore.h"
+#include "qvirtualintegration.h"
+#include "qscreen.h"
+#include <QtCore/qdebug.h>
+#include <qpa/qplatformscreen.h>
+#include <private/qguiapplication_p.h>
+
+QT_BEGIN_NAMESPACE
+
+using namespace Qt::StringLiterals;
+
+QVirtualBackingStore::QVirtualBackingStore(QWindow *window)
+    : QPlatformBackingStore(window)
+{
+}
+
+QVirtualBackingStore::~QVirtualBackingStore()
+{
+}
+
+QPaintDevice *QVirtualBackingStore::paintDevice()
+{
+    return &mImage;
+}
+
+void QVirtualBackingStore::flush(QWindow *window, const QRegion &region, const QPoint &offset)
+{
+    static_cast<QVirtualWindow *>(window->handle())->m_delegate->flush(window, &mImage, region, offset);
+}
+
+void QVirtualBackingStore::resize(const QSize &size, const QRegion &)
+{
+    QImage::Format format = QGuiApplication::primaryScreen()->handle()->format();
+    if (mImage.size() != size)
+        mImage = QImage(size, format);
+}
+
+QT_END_NAMESPACE
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/platforms/virtual/qvirtualbackingstore.h qt-everywhere-src-6.9.2/qtbase/src/plugins/platforms/virtual/qvirtualbackingstore.h
--- qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/platforms/virtual/qvirtualbackingstore.h	1969-12-31 16:00:00.000000000 -0800
+++ qt-everywhere-src-6.9.2/qtbase/src/plugins/platforms/virtual/qvirtualbackingstore.h	2025-10-02 14:40:35.411210303 -0700
@@ -0,0 +1,29 @@
+// Copyright (C) 2016 The Qt Company Ltd.
+// SPDX-License-Identifier: LicenseRef-Qt-Commercial OR LGPL-3.0-only OR GPL-2.0-only OR GPL-3.0-only
+
+#ifndef QBACKINGSTORE_VIRTUAL_H
+#define QBACKINGSTORE_VIRTUAL_H
+
+#include <qpa/qplatformbackingstore.h>
+#include <qpa/qplatformwindow.h>
+#include <QtGui/QImage>
+
+QT_BEGIN_NAMESPACE
+
+class QVirtualBackingStore : public QPlatformBackingStore
+{
+public:
+    QVirtualBackingStore(QWindow *window);
+    ~QVirtualBackingStore();
+
+    QPaintDevice *paintDevice() override;
+    void flush(QWindow *window, const QRegion &region, const QPoint &offset) override;
+    void resize(const QSize &size, const QRegion &staticContents) override;
+
+private:
+    QImage mImage;
+};
+
+QT_END_NAMESPACE
+
+#endif
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/platforms/virtual/qvirtualintegration.cpp qt-everywhere-src-6.9.2/qtbase/src/plugins/platforms/virtual/qvirtualintegration.cpp
--- qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/platforms/virtual/qvirtualintegration.cpp	1969-12-31 16:00:00.000000000 -0800
+++ qt-everywhere-src-6.9.2/qtbase/src/plugins/platforms/virtual/qvirtualintegration.cpp	2025-10-02 14:40:35.411255739 -0700
@@ -0,0 +1,167 @@
+// Copyright (C) 2016 The Qt Company Ltd.
+// SPDX-License-Identifier: LicenseRef-Qt-Commercial OR LGPL-3.0-only OR GPL-2.0-only OR GPL-3.0-only
+
+#include "qvirtualintegration.h"
+#include "qvirtualbackingstore.h"
+#include "qvirtualnativeinterface.h"
+
+#include <QtCore/qabstracteventdispatcher.h>
+#include <QtCore/private/qtimerinfo_unix_p.h>
+#include <QtGui/private/qpixmap_raster_p.h>
+#include <QtGui/private/qguiapplication_p.h>
+#include <qpa/qplatformnativeinterface.h>
+#include <qpa/qplatformwindow.h>
+#include <qpa/qwindowsysteminterface.h>
+
+#if QT_CONFIG(freetype)
+#include <QtGui/private/qfreetypefontdatabase_p.h>
+#endif
+
+QT_BEGIN_NAMESPACE
+
+using namespace Qt::StringLiterals;
+
+QVirtualIntegration::QVirtualIntegration(const QStringList &parameters)
+{
+    Q_UNUSED(parameters);
+}
+
+QVirtualIntegration::~QVirtualIntegration()
+{
+    if (m_primaryScreen) {
+        QWindowSystemInterface::handleScreenRemoved(m_primaryScreen);
+    }
+    setPlatformDelegate(nullptr);
+}
+
+void QVirtualIntegration::setPlatformDelegate(QVirtualPlatformDelegate *delegate)
+{
+    if (m_delegate) {
+        m_delegate->release();
+    }
+    m_delegate = delegate;
+}
+
+bool QVirtualIntegration::hasCapability(QPlatformIntegration::Capability cap) const
+{
+    switch (cap) {
+    case ThreadedPixmaps: return true;
+    case MultipleWindows: return true;
+    case RhiBasedRendering: return false;
+    default: return QPlatformIntegration::hasCapability(cap);
+    }
+}
+
+class QVirtualFontDatabase :
+#if QT_CONFIG(freetype)
+    public QFreeTypeFontDatabase
+#else
+    public QPlatformFontDatabase
+#endif
+{
+    virtual void populateFontDatabase() override { }
+};
+
+QPlatformFontDatabase *QVirtualIntegration::fontDatabase() const
+{
+    if (!m_fontDatabase)
+        m_fontDatabase.reset( new QVirtualFontDatabase );
+
+    return m_fontDatabase.data();
+}
+
+QPlatformWindow *QVirtualIntegration::createPlatformWindow(QWindow *window) const
+{
+    QVirtualWindow *w = Q_NULLPTR;
+    if (m_delegate) {
+        QVirtualWindowDelegate *delegate = m_delegate->createWindowDelegate(window);
+        if (delegate) {
+            w = new QVirtualWindow(window, delegate);
+            w->requestActivateWindow();
+        }
+    }
+    return w;
+}
+
+QPlatformBackingStore *QVirtualIntegration::createPlatformBackingStore(QWindow *window) const
+{
+    return new QVirtualBackingStore(window);
+}
+
+class QVirtualEventDispatcher : public QAbstractEventDispatcherV2
+{
+public:
+    QVirtualEventDispatcher() { }
+    virtual ~QVirtualEventDispatcher() { }
+
+    virtual bool processEvents(QEventLoop::ProcessEventsFlags flags) override {
+        Q_UNUSED(flags);
+
+        emit awake();
+        QCoreApplication::sendPostedEvents();
+        QWindowSystemInterface::sendWindowSystemEvents(QEventLoop::AllEvents);
+        timerInfoList.activateTimers();
+
+        // ~120 FPS update rate
+        QThread::msleep( 8 );
+        return true;
+    }
+
+    virtual void registerSocketNotifier(QSocketNotifier *notifier) override {
+        Q_UNUSED(notifier);
+        qDebug() << __FUNCTION__;
+    }
+    virtual void unregisterSocketNotifier(QSocketNotifier *notifier) override {
+        Q_UNUSED(notifier);
+        qDebug() << __FUNCTION__;
+    }
+
+    virtual void registerTimer(Qt::TimerId timerId, Duration interval, Qt::TimerType timerType, QObject *object) override {
+        timerInfoList.registerTimer(timerId, interval, timerType, object);
+    }
+    virtual bool unregisterTimer(Qt::TimerId timerId) override {
+        return timerInfoList.unregisterTimer(timerId);
+    }
+    virtual bool unregisterTimers(QObject *object) override {
+        return timerInfoList.unregisterTimers(object);
+    }
+    virtual QList<TimerInfoV2> timersForObject(QObject *object) const override {
+        return timerInfoList.registeredTimers(object);
+    }
+    virtual Duration remainingTime(Qt::TimerId timerId) const override {
+        return timerInfoList.remainingDuration(timerId);
+    }
+
+    virtual void wakeUp() override { }
+    virtual void interrupt() override { }
+
+private:
+    QTimerInfoList timerInfoList;
+};
+
+QAbstractEventDispatcher *QVirtualIntegration::createEventDispatcher() const
+{
+    return new QVirtualEventDispatcher;
+}
+
+QPlatformNativeInterface *QVirtualIntegration::nativeInterface() const
+{
+    if (!m_nativeInterface)
+        m_nativeInterface.reset(new QVirtualNativeInterface);
+
+    return m_nativeInterface.data();
+}
+
+void QVirtualIntegration::createScreen(QRect geometry)
+{
+    m_primaryScreen = new QVirtualScreen();
+    m_primaryScreen->mGeometry = geometry;
+    QWindowSystemInterface::handleScreenAdded(m_primaryScreen);
+}
+
+QVirtualIntegration *QVirtualIntegration::instance()
+{
+    return static_cast<QVirtualIntegration *>(QGuiApplicationPrivate::platformIntegration());
+}
+
+QT_END_NAMESPACE
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/platforms/virtual/qvirtualintegration.h qt-everywhere-src-6.9.2/qtbase/src/plugins/platforms/virtual/qvirtualintegration.h
--- qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/platforms/virtual/qvirtualintegration.h	1969-12-31 16:00:00.000000000 -0800
+++ qt-everywhere-src-6.9.2/qtbase/src/plugins/platforms/virtual/qvirtualintegration.h	2025-10-02 14:40:35.411320150 -0700
@@ -0,0 +1,108 @@
+// Copyright (C) 2016 The Qt Company Ltd.
+// SPDX-License-Identifier: LicenseRef-Qt-Commercial OR LGPL-3.0-only OR GPL-2.0-only OR GPL-3.0-only
+
+#ifndef QPLATFORMINTEGRATION_VIRTUAL_H
+#define QPLATFORMINTEGRATION_VIRTUAL_H
+
+#include <qpa/qplatformfontdatabase.h>
+#include <qpa/qplatformintegration.h>
+#include <qpa/qplatformscreen.h>
+#include <qpa/qplatformwindow.h>
+#include <QtGui/qvirtualplatform.h>
+
+#include <qscopedpointer.h>
+
+QT_BEGIN_NAMESPACE
+
+class QVirtualScreen : public QPlatformScreen
+{
+public:
+    QVirtualScreen()
+        : mGeometry(0, 0, 320, 200), mDepth(32), mFormat(QImage::Format_ARGB32_Premultiplied) {}
+
+    QRect geometry() const override { return mGeometry; }
+    int depth() const override { return mDepth; }
+    QImage::Format format() const override { return mFormat; }
+
+public:
+    QRect mGeometry;
+    int mDepth;
+    QImage::Format mFormat;
+    QSize mPhysicalSize;
+};
+
+class QVirtualWindow : public QPlatformWindow
+{
+public:
+    QVirtualWindow(QWindow *window, QVirtualWindowDelegate *delegate) : QPlatformWindow(window), m_delegate(delegate) {
+    }
+
+    ~QVirtualWindow() { m_delegate->release(); }
+
+    virtual void setGeometry(const QRect &rect) override {
+        QPlatformWindow::setGeometry(rect);
+        m_delegate->setGeometry(rect);
+    }
+
+    virtual void setVisible(bool visible) override {
+        QPlatformWindow::setVisible(visible);
+        m_delegate->setVisible(visible);
+    }
+
+    virtual void setWindowFlags(Qt::WindowFlags flags) override {
+        QPlatformWindow::setWindowFlags(flags);
+        m_delegate->setWindowFlags(flags);
+    }
+
+    virtual void setWindowState(Qt::WindowStates state) override {
+        QPlatformWindow::setWindowState(state);
+        m_delegate->setWindowState(state);
+    }
+
+    virtual void setWindowTitle(const QString &title) override {
+        QPlatformWindow::setWindowTitle(title);
+        m_delegate->setWindowTitle(title);
+    }
+
+    virtual void setWindowIcon(const QIcon &icon) override {
+        QPlatformWindow::setWindowIcon(icon);
+        m_delegate->setWindowIcon(icon);
+    }
+
+    virtual void propagateSizeHints() override { }
+
+public:
+    QVirtualWindowDelegate *m_delegate;
+};
+
+class QVirtualIntegration : public QVirtualPlatform, public QPlatformIntegration
+{
+public:
+    explicit QVirtualIntegration(const QStringList &parameters);
+    ~QVirtualIntegration();
+
+    QVirtualPlatformDelegate *delegate() const { return m_delegate; }
+    void setPlatformDelegate(QVirtualPlatformDelegate *delegate) override;
+
+    bool hasCapability(QPlatformIntegration::Capability cap) const override;
+    QPlatformFontDatabase *fontDatabase() const override;
+
+    QPlatformWindow *createPlatformWindow(QWindow *window) const override;
+    QPlatformBackingStore *createPlatformBackingStore(QWindow *window) const override;
+    QAbstractEventDispatcher *createEventDispatcher() const override;
+    QPlatformNativeInterface *nativeInterface() const override;
+
+    void createScreen(QRect geometry) override;
+
+    static QVirtualIntegration *instance();
+
+private:
+    QVirtualPlatformDelegate *m_delegate = Q_NULLPTR;
+    QVirtualScreen *m_primaryScreen = Q_NULLPTR;
+    mutable QScopedPointer<QPlatformFontDatabase> m_fontDatabase;
+    mutable QScopedPointer<QPlatformNativeInterface> m_nativeInterface;
+};
+
+QT_END_NAMESPACE
+
+#endif
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/platforms/virtual/qvirtualnativeinterface.cpp qt-everywhere-src-6.9.2/qtbase/src/plugins/platforms/virtual/qvirtualnativeinterface.cpp
--- qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/platforms/virtual/qvirtualnativeinterface.cpp	1969-12-31 16:00:00.000000000 -0800
+++ qt-everywhere-src-6.9.2/qtbase/src/plugins/platforms/virtual/qvirtualnativeinterface.cpp	2025-10-02 14:40:35.411378380 -0700
@@ -0,0 +1,54 @@
+/****************************************************************************
+**
+** Copyright (C) 2016 The Qt Company Ltd.
+** Contact: https://www.qt.io/licensing/
+**
+** This file is part of the plugins of the Qt Toolkit.
+**
+** $QT_BEGIN_LICENSE:LGPL$
+** Commercial License Usage
+** Licensees holding valid commercial Qt licenses may use this file in
+** accordance with the commercial license agreement provided with the
+** Software or, alternatively, in accordance with the terms contained in
+** a written agreement between you and The Qt Company. For licensing terms
+** and conditions see https://www.qt.io/terms-conditions. For further
+** information use the contact form at https://www.qt.io/contact-us.
+**
+** GNU Lesser General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU Lesser
+** General Public License version 3 as published by the Free Software
+** Foundation and appearing in the file LICENSE.LGPL3 included in the
+** packaging of this file. Please review the following information to
+** ensure the GNU Lesser General Public License version 3 requirements
+** will be met: https://www.gnu.org/licenses/lgpl-3.0.html.
+**
+** GNU General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU
+** General Public License version 2.0 or (at your option) the GNU General
+** Public license version 3 or any later version approved by the KDE Free
+** Qt Foundation. The licenses are as published by the Free Software
+** Foundation and appearing in the file LICENSE.GPL2 and LICENSE.GPL3
+** included in the packaging of this file. Please review the following
+** information to ensure the GNU General Public License requirements will
+** be met: https://www.gnu.org/licenses/gpl-2.0.html and
+** https://www.gnu.org/licenses/gpl-3.0.html.
+**
+** $QT_END_LICENSE$
+**
+****************************************************************************/
+
+#include "qvirtualnativeinterface.h"
+
+#include "qvirtualintegration.h"
+
+QT_BEGIN_NAMESPACE
+
+void *QVirtualNativeInterface::nativeResourceForIntegration(const QByteArray &resource)
+{
+    if (resource == "platform") {
+        return QVirtualIntegration::instance();
+    }
+    return QPlatformNativeInterface::nativeResourceForIntegration(resource);
+}
+
+QT_END_NAMESPACE
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/platforms/virtual/qvirtualnativeinterface.h qt-everywhere-src-6.9.2/qtbase/src/plugins/platforms/virtual/qvirtualnativeinterface.h
--- qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/platforms/virtual/qvirtualnativeinterface.h	1969-12-31 16:00:00.000000000 -0800
+++ qt-everywhere-src-6.9.2/qtbase/src/plugins/platforms/virtual/qvirtualnativeinterface.h	2025-10-02 14:40:35.411429567 -0700
@@ -0,0 +1,59 @@
+/****************************************************************************
+**
+** Copyright (C) 2016 The Qt Company Ltd.
+** Contact: https://www.qt.io/licensing/
+**
+** This file is part of the plugins of the Qt Toolkit.
+**
+** $QT_BEGIN_LICENSE:LGPL$
+** Commercial License Usage
+** Licensees holding valid commercial Qt licenses may use this file in
+** accordance with the commercial license agreement provided with the
+** Software or, alternatively, in accordance with the terms contained in
+** a written agreement between you and The Qt Company. For licensing terms
+** and conditions see https://www.qt.io/terms-conditions. For further
+** information use the contact form at https://www.qt.io/contact-us.
+**
+** GNU Lesser General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU Lesser
+** General Public License version 3 as published by the Free Software
+** Foundation and appearing in the file LICENSE.LGPL3 included in the
+** packaging of this file. Please review the following information to
+** ensure the GNU Lesser General Public License version 3 requirements
+** will be met: https://www.gnu.org/licenses/lgpl-3.0.html.
+**
+** GNU General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU
+** General Public License version 2.0 or (at your option) the GNU General
+** Public license version 3 or any later version approved by the KDE Free
+** Qt Foundation. The licenses are as published by the Free Software
+** Foundation and appearing in the file LICENSE.GPL2 and LICENSE.GPL3
+** included in the packaging of this file. Please review the following
+** information to ensure the GNU General Public License requirements will
+** be met: https://www.gnu.org/licenses/gpl-2.0.html and
+** https://www.gnu.org/licenses/gpl-3.0.html.
+**
+** $QT_END_LICENSE$
+**
+****************************************************************************/
+
+#ifndef QVIRTUALNATIVEINTERFACE_H
+#define QVIRTUALNATIVEINTERFACE_H
+
+#include <qpa/qplatformnativeinterface.h>
+
+QT_BEGIN_NAMESPACE
+
+class QVirtualNativeInterface : public QPlatformNativeInterface
+{
+    Q_OBJECT
+public:
+
+    QVirtualNativeInterface() { }
+
+    virtual void *nativeResourceForIntegration(const QByteArray &resource) override;
+};
+
+QT_END_NAMESPACE
+
+#endif // QVIRTUALNATIVEINTERFACE_H
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/platforms/virtual/virtual.json qt-everywhere-src-6.9.2/qtbase/src/plugins/platforms/virtual/virtual.json
--- qt-everywhere-src-6.9.2.orig/qtbase/src/plugins/platforms/virtual/virtual.json	1969-12-31 16:00:00.000000000 -0800
+++ qt-everywhere-src-6.9.2/qtbase/src/plugins/platforms/virtual/virtual.json	2025-10-02 14:40:35.411481134 -0700
@@ -0,0 +1,3 @@
+{
+    "Keys": [ "virtual" ]
+}
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/widgets/dialogs/qdialog.cpp qt-everywhere-src-6.9.2/qtbase/src/widgets/dialogs/qdialog.cpp
--- qt-everywhere-src-6.9.2.orig/qtbase/src/widgets/dialogs/qdialog.cpp	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/widgets/dialogs/qdialog.cpp	2025-10-02 14:40:35.411555855 -0700
@@ -1071,6 +1071,31 @@
 #endif
 }
 
+/*! \reimp */
+void QDialog::controllerEvent(QControllerEvent *e)
+{
+    // Don't pass controller events on when a dialog is up
+    e->accept();
+
+    if (e->isButtonAPress() || e->isButtonARelease() || e->isButtonBPress() || e->isButtonBRelease()) {
+        if (e->isButtonAPress()) {
+            QList<QPushButton*> list = findChildren<QPushButton*>();
+            for (int i=0; i<list.size(); ++i) {
+                QPushButton *pb = list.at(i);
+                if (pb->isDefault() && pb->isVisible()) {
+                    if (pb->isEnabled())
+                        pb->click();
+                    return;
+                }
+            }
+        } else if (e->isButtonBPress()) {
+            reject();
+        }
+    } else {
+        QWidget::controllerEvent(e);
+    }
+}
+
 /*! \fn void QDialog::finished(int result)
 
     This signal is emitted when the dialog's \a result code has been
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/widgets/dialogs/qdialog.h qt-everywhere-src-6.9.2/qtbase/src/widgets/dialogs/qdialog.h
--- qt-everywhere-src-6.9.2.orig/qtbase/src/widgets/dialogs/qdialog.h	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/widgets/dialogs/qdialog.h	2025-10-02 14:40:35.411702672 -0700
@@ -65,6 +65,7 @@
 #ifndef QT_NO_CONTEXTMENU
     void contextMenuEvent(QContextMenuEvent *) override;
 #endif
+    void controllerEvent(QControllerEvent *) override;
     bool eventFilter(QObject *, QEvent *) override;
     void adjustPosition(QWidget*);
 private:
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/widgets/kernel/qwidget.cpp qt-everywhere-src-6.9.2/qtbase/src/widgets/kernel/qwidget.cpp
--- qt-everywhere-src-6.9.2.orig/qtbase/src/widgets/kernel/qwidget.cpp	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/widgets/kernel/qwidget.cpp	2025-10-02 14:40:35.412178048 -0700
@@ -8948,6 +8948,7 @@
 #if QT_CONFIG(wheelevent)
         case QEvent::Wheel:
 #endif
+        case QEvent::Controller:
             return false;
         default:
             break;
@@ -9401,6 +9402,11 @@
             d->updateFont(d->data.fnt);
         d->renderToTextureReallyDirty = 1;
         break;
+
+    case QEvent::Controller:
+        controllerEvent((QControllerEvent*)event);
+        break;
+
     case QEvent::DynamicPropertyChange: {
         const QByteArray &propName = static_cast<QDynamicPropertyChangeEvent *>(event)->propertyName();
         if (propName.size() == 13 && !qstrncmp(propName, "_q_customDpi", 12)) {
@@ -10196,6 +10202,25 @@
 }
 
 /*!
+    \fn void QWidget::controllerEvent(QControllerEvent *event)
+
+    This event handler can be reimplemented in a subclass to receive
+    controller events. The event is passed in the \a event parameter.
+
+    \sa event(), QControllerEvent
+*/
+void QWidget::controllerEvent(QControllerEvent *event)
+{
+    if ((windowType() == Qt::Popup) && (event->isButtonBPress() || event->isButtonBRelease())) {
+        event->accept();
+        if (event->isButtonBRelease())
+            close();
+    } else {
+        event->ignore();
+    }
+}
+
+/*!
     Ensures that the widget and its children have been polished by
     QStyle (i.e., have a proper font and palette).
 
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/widgets/kernel/qwidget.h qt-everywhere-src-6.9.2/qtbase/src/widgets/kernel/qwidget.h
--- qt-everywhere-src-6.9.2.orig/qtbase/src/widgets/kernel/qwidget.h	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/widgets/kernel/qwidget.h	2025-10-02 14:40:35.412898536 -0700
@@ -57,6 +57,7 @@
 class QScreen;
 class QShowEvent;
 class QHideEvent;
+class QControllerEvent;
 class QIcon;
 class QBackingStore;
 class QPlatformWindow;
@@ -702,6 +703,8 @@
 
     virtual bool nativeEvent(const QByteArray &eventType, void *message, qintptr *result);
 
+    virtual void controllerEvent(QControllerEvent *);
+
     // Misc. protected functions
     virtual void changeEvent(QEvent *);
 
diff -ruN qt-everywhere-src-6.9.2.orig/qtbase/src/widgets/util/qflickgesture.cpp qt-everywhere-src-6.9.2/qtbase/src/widgets/util/qflickgesture.cpp
--- qt-everywhere-src-6.9.2.orig/qtbase/src/widgets/util/qflickgesture.cpp	2025-08-10 21:54:51.000000000 -0700
+++ qt-everywhere-src-6.9.2/qtbase/src/widgets/util/qflickgesture.cpp	2025-10-02 14:40:35.413024835 -0700
@@ -78,7 +78,7 @@
 
     static PressDelayHandler *instance()
     {
-        static PressDelayHandler *inst = nullptr;
+        static QPointer<PressDelayHandler> inst = nullptr;
         if (!inst)
             inst = new PressDelayHandler(QCoreApplication::instance());
         return inst;
